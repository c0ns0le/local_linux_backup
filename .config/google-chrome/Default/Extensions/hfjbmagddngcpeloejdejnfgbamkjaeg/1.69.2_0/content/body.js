"use strict";if(!"".startsWith){String.prototype.startsWith=function(e){return e.length<=this.length&&0===this.lastIndexOf(e,0)};"".endsWith||(String.prototype.endsWith=function(e){var t=this.length-e.length;return 0<=t&&this.indexOf(e,t)===t})}var VUtils={jsRe:/^javascript:/i,_imageUrlRe:/\.(?:bmp|gif|ico|jpe?g|png|svg|tiff?|webp)\b/i,isImageUrl:function(e){if(!e||"#"===e[0]||e.length<5||e.startsWith("data:")||this.jsRe.test(e))return false;var t=e.lastIndexOf("#")+1||e.length;e=e.substring(e.lastIndexOf("/",e.lastIndexOf("?")+1||t),t);return this._imageUrlRe.test(e)},safer:function(e){return Object.setPrototypeOf(e,null)},execCommand:function(e,t,i,n){var o=t.split("."),r,s;for(r=0,s=o.length-1;r<s;r++)e=e[o[r]];return e[o[r]](i,n?this.safer(n):Object.create(null))},decodeURL:function(e){try{e=decodeURI(e)}catch(e){}return e},hasUpperCase:function(e){return e.toLowerCase()!==e},Stop:function(e){e.stopImmediatePropagation()},prevent:function(e){e.preventDefault();this.Stop(e)},suppressAll:function(e,t,i){(i?removeEventListener:addEventListener).call(e,t,this.Stop,{passive:true,capture:true})},_stack:[],push:function(e,t){return this._stack.push({func:e,env:t})},bubbleEvent:function(e){for(var t=this._stack,i=t.length;0<=--i;){var n=t[i],o=n.func.call(n.env,e);if(0!==o)return o}return 0},remove:function(e){for(var t=this._stack,i=t.length;0<=--i;)if(t[i].env===e){i===t.length-1?t.length--:t.splice(i,1);break}}},VKeyboard={keyNames:["space","pageup","pagedown","end","home","left","up","right","down"],correctionMap:{__proto__:null,0:";:",1:"=+",2:",<",3:"-_",4:".>",5:"/?",6:"`~",33:"[{",34:"\\|",35:"]}",36:"'\""},funcKeyRe:/^F\d\d?$/,getKeyName:function(e){var t=e.keyCode,i=e.shiftKey,n;return t<41?(n=31<t?this.keyNames[t-32]:8===t?"backspace":9===t?"tab":13===t?"enter":"",i?n&&n.toUpperCase():n):t<47&&44<t?45<t?"delete":"insert":(n=e.key)?this.funcKeyRe.test(n)?i?n:n.toLowerCase():"":111<t&&t<132?"fF"[+i]+(t-111):""},getKeyCharUsingKeyIdentifier:function(e){var t=e.keyIdentifier||"";if(!t.startsWith("U+"))return"";var i=parseInt(t.substring(2),16);return i<65?i<33?"":e.shiftKey&&47<i&&i<58?")!@#$%^&*("[i-48]:String.fromCharCode(i):i<91?String.fromCharCode(i+(e.shiftKey?0:32)):185<i&&(t=this.correctionMap[i-186])&&t[+e.shiftKey]||""},getKeyChar:function(e){var t=e.key;return t?1!==t.length||32===e.keyCode?this.getKeyName(e):t:e.keyCode&&this.getKeyName(e)||this.getKeyCharUsingKeyIdentifier(e)},getKey:function(e,t){var i=e.metaKey?"<m-":"<";return e.ctrlKey?i+(e.altKey?"c-a-":"c-")+t+">":e.altKey?i+"a-"+t+">":e.metaKey||1<t.length?i+t+">":t},getKeyStat:function(e){return e.altKey|e.ctrlKey<<1|e.metaKey<<2|e.shiftKey<<3},isEscape:function(e){if(27!==e.keyCode&&!e.ctrlKey)return false;var t=this.getKeyStat(e);return 0===t||2===t&&("BracketLeft"===e.code||"["===this.getKeyChar(e))}},VDom={UI:null,allowScripts:true,allowRAF:true,isHTML:function(){return document.documentElement instanceof HTMLElement},isStandard:true,createElement:function(e){var t=document.createElement(e),i=t instanceof HTMLElement;this.isStandard=i;this.createElement=i?document.createElement.bind(document):document.createElementNS.bind(document,"http://www.w3.org/1999/xhtml");return i?t:this.createElement(e)},documentReady:function(e){function n(){removeEventListener("DOMContentLoaded",n,true);if(VDom){VDom.documentReady=o;for(var e=0,t=r;e<t.length;e++){var i;(0,t[e])()}}r.length=0}var o=function(e){return e()};if("loading"!==document.readyState){this.documentReady=o;return e()}var r=[e];this.documentReady=function(e){r.push(e)};addEventListener("DOMContentLoaded",n,true)},parentFrame:function(){try{return window.frameElement}catch(e){return null}},getParent:function(e){var t=e.getDestinationInsertionPoints?e.getDestinationInsertionPoints():null;t&&0<t.length&&(e=t[t.length-1]);return e.parentElement||window.ShadowRoot&&e.parentNode instanceof ShadowRoot&&e.parentNode.host||null},scrollingEl:function(){return document.scrollingElement||("BackCompat"===document.compatMode?document.body:document.documentElement)},prepareCrop:function(){var l,u,a;this.prepareCrop=function(){var e=this.dbZoom,t=this.scrollingEl(),i,n;if(t)i=t.clientWidth,n=t.clientHeight;else{i=window.innerWidth,n=window.innerHeight;var o=document.documentElement,r=e/this.bZoom;if(!o)return a=(u=n)-8,l=i;i=Math.min(Math.max(i-24,o.clientWidth*r|0),i);n=Math.min(Math.max(n-24,o.clientHeight*r|0),n)}if(this.paintBox){var s=this.paintBox,r=e/this.bZoom;i=Math.min(i,s[0]*r);n=Math.min(n,s[1]*r)}a=(u=n/e)-(8/e|0);return l=i/e};this.cropRectToVisible=function(e,t,i,n){if(a<t||n<3)return null;var o=[0<e?0|e:0,0<t?0|t:0,i<l?0|i:l,n<u?0|n:u];return 3<=o[2]-o[0]&&3<=o[3]-o[1]?o:null};return this.prepareCrop()},getVisibleClientRect:function(e,t){for(var i=e.getClientRects(),n,o,r,s,l,u,a=0,c=i.length;a<c;a++){var h=i[a];if(0<h.height&&0<h.width){if(n=this.cropRectToVisible(h.left,h.top,h.right,h.bottom)){if(null==s){t||(t=window.getComputedStyle(e));s="visible"===t.visibility}if(s)return n}}else if(!r){for(var d=0,f=(r=e.children).length;d<f;d++){if("none"!==(o=window.getComputedStyle(r[d])).float||"static"!==(u=o.position)&&"relative"!==u);else{if(0!==h.height)continue;if(null==l){t||(t=window.getComputedStyle(e));l="0px"!==t.fontSize&&"0px"!==t.lineHeight||!t.display.startsWith("inline")}if(l||!o.display.startsWith("inline"))continue}if(n=this.getVisibleClientRect(r[d],o))return n}o=null}}return null},getClientRectsForAreas:function(e,t,i){var n,o,r,s,l,u,a=e.getClientRects()[0];if(!(!a||a.height<3||a.width<3)){var c=false;if(i)c=true;else{var h=document.querySelector('map[name="'+e.useMap.replace(/^#/,"").replace(/"/g,'\\"')+'"]');if(!h)return;i=h.getElementsByTagName("area")}for(var d=function(e){return 0|e},f=i.length;0<=--f;){var m=i[f],p=m.coords.split(",").map(d);switch(m.shape.toLowerCase()){case"circle":case"circ":l=p[1];o=(r=p[0])-(n=p[2]/Math.sqrt(2));r+=n;s=l-n;l+=n;n=3;break;case"default":r=a.width;l=a.height;n=s=o=0;break;case"poly":case"polygon":s=p[0],l=p[2],n=p[4];o=Math.min(s,l,n);r=Math.max(s,l,n);s=p[1],l=p[3],n=p[5];s=Math.min(s,l,n);l=Math.max(p[1],l,n);n=6;default:(r=p[2])<(o=p[0])&&(o=r,r=p[0]);(l=p[3])<(s=p[1])&&(s=l,l=p[1]);n=4}p.length<n||(u=this.cropRectToVisible(o+a.left,s+a.top,r+a.left,l+a.top))&&t.push([m,u,0,[u,0],e])}return c?0<t.length?t[0][1]:null:void 0}},paintBox:null,specialZoom:false,wdZoom:1,dbZoom:1,dScale:1,bZoom:1,getZoom:function(e){var t=document.documentElement,i=window.devicePixelRatio,n,o=+getComputedStyle(t).zoom||1,r=document.webkitFullscreenElement;Math.abs(o-i)<1e-5&&this.specialZoom&&(o=1);if(e){var s=r?null:document.body;this.bZoom=s&&(1===e||this.isInDOM(e,s))&&+getComputedStyle(s).zoom||1}for(;r&&r!==t;r=this.getParent(r))o*=+getComputedStyle(r).zoom||1;this.paintBox=null;this.dbZoom=this.bZoom*o;return this.wdZoom=Math.round(o*Math.min(i,1)*1e3)/1e3},getViewBox:function(e){var t=window.innerWidth,i=window.innerHeight,n=window.devicePixelRatio,o=Math.min(n,1);if(document.webkitIsFullScreen){this.getZoom(1);this.dScale=1;var r=this.wdZoom/o;return[0,0,t/r|0,i/r|0,0]}var s=document.documentElement,l=getComputedStyle(s),u=document.body,a=u?getComputedStyle(u):l,c=this.bZoom=u&&+a.zoom||1,h=/content|paint|strict/.test(l.contain),d="static"!==l.position||h||"none"!==l.transform,f=l.transform,m=this.dScale=f&&!f.startsWith("matrix(1,")&&parseFloat(f.slice(7))||1,p=s.getBoundingClientRect(),v=+l.zoom||1;Math.abs(v-n)<1e-5&&this.specialZoom&&(v=1);this.wdZoom=Math.round(v*o*1e3)/1e3;this.dbZoom=v*c;var g=d?-s.clientLeft:parseFloat(l.marginLeft),V=d?-s.clientTop:parseFloat(l.marginTop);g=g*m-p.left,V=V*m-p.top;g=Math.abs(g)<.01?0:Math.ceil(Math.round(g/c*100)/100);V=Math.abs(V)<.01?0:Math.ceil(Math.round(V/c*100)/100);var y=t/=v,b=i/=v;h&&(t=p.right,i=p.bottom);this.paintBox=h?[t-parseFloat(l.borderRightWidth)*m,i-parseFloat(l.borderBottomWidth)*m]:null;if(!e)return[g,V];var w=this.scrollingEl(),D="hidden"!==l.overflowX&&"hidden"!==a.overflowX,E="hidden"!==l.overflowY&&"hidden"!==a.overflowY;if(D){y+=64*c;h||(t=w?(w.scrollWidth-window.scrollX)/v:Math.max((t-24)/v,p.right))}if(E){b+=20*c;h||(i=w?(w.scrollHeight-window.scrollY)/v:Math.max((i-24)/v,p.bottom))}t=Math.min(t,y);i=(i=Math.min(i,b))/c|0;return[g,V,t=t/c|0,E?i-18:i,D?t:0]},ensureInView:function(e,t){var i=e.getBoundingClientRect(),n=this.NotVisible(null,i);if(1===n){var o=i.top,r=innerHeight,s=o<0?-1:r<o?1:0,l=null!=t;e.scrollIntoView(s<0);(s||l)&&this.scrollWndBy(0,l?t-window.scrollY:s*r/5)}return 0===n},scrollWndBy:function(e,t){HTMLElement.prototype.scrollBy?scrollBy({behavior:"instant",left:e,top:t}):scrollBy(e,t)},NotVisible:function(e,t){t||(t=e.getBoundingClientRect());return t.height<.5||t.width<.5?2:t.bottom<=0||t.top>=window.innerHeight||t.right<=0||t.left>=window.innerWidth?1:0},isInDOM:function(e,t){var i=document,n;if(!t&&"function"==typeof(n=i.getRootNode))return n.call(e,{composed:true})===i;t||(t=i);if(t.contains(e))return true;if(e instanceof HTMLFormElement)return false;for(var o,r=window.ShadowRoot||function(){};e!==t&&(o=e.parentNode);)e=o instanceof r?o.host:o;return e===t},uneditableInputs:{__proto__:null,button:1,checkbox:1,color:1,file:1,hidden:1,image:1,radio:1,range:1,reset:1,submit:1},editableTypes:{__proto__:null,input:4,textarea:3,keygen:2,select:2,embed:1,object:1},getEditableType:function(e){if(!(e instanceof HTMLElement)||e instanceof HTMLFormElement)return 0;var t=this.editableTypes[e.nodeName.toLowerCase()];return 4!==t?t||(e.isContentEditable?3:0):e.type in this.uneditableInputs?0:3},docSelectable:true,selType:function(e){e||(e=window.getSelection());return e.type},isSelected:function(e){var t=window.getSelection(),i=t.anchorNode;return true===e.isContentEditable?!!i&&i.contains(e):"Range"===this.selType(t)&&t.isCollapsed&&e===i.childNodes[t.anchorOffset]},getSelectionFocusElement:function(){var e=window.getSelection(),t=e.focusNode,i=e.focusOffset;t&&t===e.anchorNode&&i===e.anchorOffset&&(t=t.childNodes[i]);return t&&1!==t.nodeType?t.parentElement:t},findSelectionParent:function(e){for(var t=this.getSelectionFocusElement(),i=window.getSelection().anchorNode,n=0;t&&n<e&&!t.contains(i);n++)t=t.parentElement;return n<e?t:null},getElementWithFocus:function(e,t){var i=e.getRangeAt(0);"Range"===this.selType(e)&&(i=i.cloneRange()).collapse(!t);var n=i.startContainer,o;1===n.nodeType&&(n=n.childNodes[i.startOffset]||null);for(o=n;o&&1!==o.nodeType;o=o.previousSibling);return o||n&&n.parentElement},mouse:function(e,t,i,n,o){var r=document.createEvent("MouseEvents");n||(n=this.defaultMouseKeys);var s=i?(i[0]+i[2])*this.dbZoom/2|0:0,l=i?(i[1]+i[3])*this.dbZoom/2|0:0;r.initMouseEvent(t,true,true,e.ownerDocument.defaultView,t.startsWith("mouseo")?0:1,s,l,s,l,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,0,o||null);return e.dispatchEvent(r)},defaultMouseKeys:{altKey:false,ctrlKey:false,metaKey:false,shiftKey:false},lastHovered:null,hover:function(e,t){var i=this.lastHovered;i&&this.isInDOM(i)?this.mouse(i,"mouseout",null,null,e!==i?e:null):i=null;(this.lastHovered=e)&&this.mouse(e,"mouseover",t,null,i)},isContaining:function(e,t){return t[3]<=e[3]&&t[2]<=e[2]&&e[1]<=t[1]&&e[0]<=t[0]},fromClientRect:function(e){return[0|e.left,0|e.top,0|e.right,0|e.bottom]},setBoundary:function(e,t,i){if(i&&(t[1]<0||t[0]<0||t[3]>window.innerHeight||t[2]>window.innerWidth)){var n=this.getViewBox();t[0]+=n[0],t[2]+=n[0],t[1]+=n[1],t[3]+=n[1];e.position="absolute"}e.left=t[0]+"px",e.top=t[1]+"px";e.width=t[2]-t[0]+"px",e.height=t[3]-t[1]+"px"},cropRectToVisible:null,SubtractSequence:function(e){var t=this[1],i=this[0],n,o,r=Math.max(e[1],t[1]),s=Math.min(e[3],t[3]);if(s<=r||(n=Math.max(e[0],t[0]))>=(o=Math.min(e[2],t[2])))i.push(e);else{var l=e[0],u=e[2],a=e[1],c=e[3];l<n&&i.push([l,a,n,c]);a<r&&i.push([n,a,u,r]);s<c&&i.push([n,s,u,c]);o<u&&i.push([o,r,u,s])}}},VHints={CONST:{focus:134,hover:128,leave:129,unhover:129,text:130,"copy-text":130,url:137,image:133},box:null,hints:null,mode:0,mode1:0,modeOpt:null,clicking:0,forHover:false,count:0,lastMode:0,tooHigh:false,pTimer:0,isClickListened:true,ngEnabled:null,keyStatus:{known:false,newHintLength:0,tab:0},isActive:false,noHUD:false,options:null,timer:0,activate:function(e,t){if(!this.isActive){if(null==document.body){this.clean();if(!this.timer&&"loading"===document.readyState){this.timer=setTimeout(this.activate.bind(this,e,t),300);return}if(!VDom.isHTML())return}VUtils.remove(this);this.setModeOpt(0|e,t);var i=t.characters?t.characters+"":VSettings.cache.linkHintCharacters;if(i.length<3){this.clean(true);return VHUD.showForDuration("Characters for LinkHints are too few.",1e3)}var n=VDom.getViewBox(1);VDom.prepareCrop();null!==this.tooHigh&&(this.tooHigh=20<(VDom.scrollingEl()||document.documentElement).scrollHeight/window.innerHeight);var o=this.getVisibleElements(n);if(this.frameNested&&this.tryNestedFrame("VHints.activate",0|e,t))return this.clean();if(0===o.length&&0===(o=this.retryShadowDOM(n)).length){this.clean(true);return VHUD.showForDuration("No links to select.",1e3)}if(this.box){this.box.remove();this.box=null}this.hints=o.map(this.createHint,this);1!==VDom.bZoom&&this.adjustMarkers(o);o=null;this.alphabetHints.initMarkers(this.hints,i);this.noHUD=n[3]<=40||n[2]<=320||true===(t.hideHUD||t.hideHud);VDom.UI.ensureBorder(VDom.wdZoom);this.setMode(this.mode,false);this.box=VDom.UI.addElementList(this.hints,n);this.isActive=true;VUtils.push(this.onKeydown,this);return VEventMode.onWndBlur(this.ResetMode)}},setModeOpt:function(e,t){if(this.options!==t){var i=this.Modes,n,o=0|(0<t.mode?t.mode:this.CONST[t.action||t.mode]);257===o&&t.url&&(o=256);1<(e=Math.abs(e))&&(o<256?o|=64:e=1);for(var r in i)if(i.hasOwnProperty(r)&&i[r].hasOwnProperty(o)){n=i[r];break}if(!n){n=i.DEFAULT;o=1<e?66:0}this.modeOpt=n;this.options=t;this.count=e;return this.setMode(o,true)}},setMode:function(e,t){this.lastMode=this.mode=e;this.mode1=e&=-65;this.forHover=128<=e&&e<=129;if(!t&&!this.noHUD){if(!(this.pTimer<0))return VHUD.show(this.modeOpt[this.mode],true);this.pTimer=setTimeout(this.SetHUDLater,1e3)}},SetHUDLater:function(){var e=VHints;if(e&&e.isActive){e.pTimer=0;return e.setMode(e.mode)}},activateAndFocus:function(e,t){return VEventMode.focusAndListen(function(){VHints.isActive=false;VHints.activate(e,t)})},tryNestedFrame:function(e,t,i){if(null!==this.frameNested){e.startsWith("VHints")||VDom.prepareCrop();this.checkNestedFrame()}var n=this.frameNested,o=null,r=true,s=false;if(!n)return false;try{if(n.contentDocument&&(o=n.contentWindow).VDom.isHTML()){"VHints.activate"===e&&(s=o.VHints.isActive)&&o.VHints.deactivate(true);r=o.VEventMode.keydownEvents(VEventMode.keydownEvents())}}catch(e){}if(r){this.frameNested=null;return false}o.VEventMode.focusAndListen(s?null:function(){return VUtils.execCommand(o,e,t,i)});if(s)return true;"complete"!==document.readyState&&(this.frameNested=false);return true},retryShadowDOM:function(e){var t=[];if(1===this.clicking&&!this.tooHigh){var i=VSettings.cache;if(!i.deepHints){i.deepHints=true;t=this.getVisibleElements(e)}0!==t.length||this.switchShadowVer()||(t=this.getVisibleElements(e))}return t},maxLeft:0,maxTop:0,maxRight:0,zIndexes:null,createHint:function(e){var t=VDom.createElement("span"),i;i=e.length<4?e[1][0]:e[3][0][0]+e[3][1];var n={marker:t,target:e[0],key:"",refer:4<e.length?e[4]:null};if(e[2]<7)t.className="LH";else{t.className="LH BH";n.scroll=true}var o=t.style;o.left=i+"px";this.maxLeft<i&&this.maxRight&&(o.maxWidth=this.maxRight-i+"px");o.top=(i=e[1][1])+"px";this.maxTop<i&&(o.maxHeight=this.maxTop-i+18+"px");return n},adjustMarkers:function(e){var t=VDom.bZoom,i=VDom.UI.root,n=e.length-1;if(i&&(e[n][0]===Vomnibar.box||i.querySelector("#HelpDialog")))for(var o=(""+1/t).substring(0,5),r=this.hints,s=this.maxRight*t,l=this.maxTop*t;0<=n&&i.contains(e[n][0]);){var u=r[n--].marker.style;u.zoom=o;u.maxWidth&&(u.maxWidth=s-e[n][1][0]+"px");u.maxHeight&&(u.maxHeight=l-e[n][1][1]+18+"px")}},btnRe:/\b(?:[Bb](?:utto|t)n|[Cc]lose)(?:$|\s)/,GetClickable:function(e){var t,i=null,n,o=0;if(e instanceof HTMLElement&&!(e instanceof HTMLFormElement)){switch(e.tagName.toUpperCase()){case"A":case"DETAILS":i=true;break;case"FRAME":case"IFRAME":if(e===Vomnibar.box){if(t=VDom.getVisibleClientRect(e)){t[0]+=10.5;t[1]+=8;this.push([e,t,7])}return}o=(i=e!==VFindMode.box)?7:0;break;case"INPUT":if("hidden"===e.type)return;case"TEXTAREA":if(e.disabled&&VHints.mode1<=129)return;(!e.readOnly||128<=VHints.mode||e instanceof HTMLInputElement&&e.type in VDom.uneditableInputs)&&(i=true);break;case"LABEL":if(e.control){var r=e.control,s=[];if(r.getAttribute("disabled"))return;VHints.GetClickable.call(s,r);i=0===s.length}break;case"BUTTON":case"SELECT":i=!e.disabled||129<VHints.mode1;break;case"OBJECT":case"EMBED":if((n=e.type)&&n.endsWith("x-shockwave-flash")){i=true;break}e instanceof HTMLObjectElement&&e.useMap&&VDom.getClientRectsForAreas(e,this);return;case"IMG":e.useMap&&VDom.getClientRectsForAreas(e,this);(VHints.forHover&&!(e.parentNode instanceof HTMLAnchorElement)||((n=e.style.cursor)?"default"!==n:(n=getComputedStyle(e).cursor)&&(0<=n.indexOf("zoom")||n.startsWith("url"))))&&(i=true);break;case"DIV":case"UL":case"PRE":case"OL":case"CODE":o=(o=e.clientHeight)&&o+5<e.scrollHeight?9:(o=e.clientWidth)&&o+5<e.scrollWidth?8:0}null===i&&(o="inherit"!==(n=e.contentEditable)&&n&&"false"!==n?1:e.vimiumHasOnclick&&VHints.isClickListened||e.getAttribute("onclick")||VHints.ngEnabled&&e.getAttribute("ng-click")||(n=e.getAttribute("role"))&&("button"===(n=n.toLowerCase())||"link"===n||"tab"===n||"checkbox"===n||"radio"===n||n.startsWith("menuitem"))||VHints.forHover&&e.getAttribute("onmouseover")||(n=e.getAttribute("jsaction"))&&VHints.checkJSAction(n)?2:(n=e.getAttribute("tabindex"))&&0<=parseInt(n,10)?5:5<o?o:(n=e.className)&&VHints.btnRe.test(n)?4:0);if(i||0!==o){VHints.clicking=2;e!==document.documentElement&&e!==document.body&&(t=VDom.getVisibleClientRect(e))&&(o<8||VScroller.shouldScroll(e,o-8))&&(null==(n=e.getAttribute("aria-hidden"))||n&&"true"!==n.toLowerCase())&&(null==(n=e.getAttribute("aria-disabled"))||n&&"true"!==n.toLowerCase()||128<=VHints.mode)&&this.push([e,t,o])}}else e instanceof SVGElement&&0<(o=e.vimiumHasOnclick||e.getAttribute("onclick")||VHints.ngEnabled&&e.getAttribute("ng-click")||(n=e.getAttribute("jsaction"))&&VHints.checkJSAction(n)?2:(n=e.getAttribute("tabindex"))&&0<=parseInt(n,10)?5:o)&&(t=VDom.getVisibleClientRect(e))&&this.push([e,t,o])},noneActionRe:/\._\b(?![\$\.])/,checkJSAction:function(e){for(var t=0,i=e.split(";");t<i.length;t++){var n=i[t],o=(n=n.trim()).startsWith("click:")?n=n.substring(6):n&&-1===n.indexOf(":")?n:null;if(o&&"none"!==o&&!this.noneActionRe.test(o))return true}return false},GetEditable:function(e){if(e instanceof HTMLElement&&!(e instanceof HTMLFormElement)){var t,i=0,n;switch(e.tagName.toUpperCase()){case"INPUT":if(e.type in VDom.uneditableInputs)return;case"TEXTAREA":if(e.disabled||e.readOnly)return;break;default:if("inherit"===(n=e.contentEditable)||!n||"false"===n)return;i=1}(t=VDom.getVisibleClientRect(e))&&this.push([e,t,i])}},GetLinks:function(e){var t,i;e instanceof HTMLAnchorElement&&((t=e.getAttribute("href"))&&"#"!==t&&!VUtils.jsRe.test(t)||e.hasAttribute("data-vim-url"))&&(i=VDom.getVisibleClientRect(e))&&this.push([e,i,0])},getImagesInImg:function(e,t){if(t.src||t.getAttribute("data-src")){var i,n=null,o,r;if((o=t.width)<8&&(r=t.height)<8){if(o!==r||0!==o&&3!==o)return;(i=t.getClientRects()[0])&&(n=VDom.cropRectToVisible(o=i.left,r=i.top,o+8,r+8))}else(i=t.getClientRects()[0])&&(n=VDom.cropRectToVisible(i.left,i.top,o=i.right+(i.width<3?3:0),r=i.bottom+(i.height<3?3:0)));n&&"visible"===getComputedStyle(t).visibility&&e.push([t,n,0])}},GetImages:function(e){if(e instanceof HTMLImageElement)return VHints.getImagesInImg(this,e);if(e instanceof HTMLElement&&!(e instanceof HTMLFormElement)){var t=e.getAttribute("data-src")||e.getAttribute("href"),i;VUtils.isImageUrl(t)&&(i=VDom.getVisibleClientRect(e))&&this.push([e,i,0])}},_shadowSign:"* /deep/ ",traverse:function(e,t,i,n){null===this.ngEnabled&&"*"===e&&(this.ngEnabled=null!=document.querySelector(".ng-scope"));var o=e,r=VDom.UI.box===VDom.UI.root||i?null:VDom.UI.root;if(VSettings.cache.deepHints){o=this._shadowSign+e;r&&"closed"!==r.mode&&(r=null)}var s=[],l="*"===o||/^[a-z]+$/.test(o),u=VScroller,a=t===this.GetClickable&&"*"===e,c=n||document.webkitFullscreenElement||document;a&&u.getScale();this.clicking=a?1:0;var h=l?c.getElementsByTagName(o):c.querySelectorAll(o);!n&&this.tooHigh&&c===document&&15e3<=h.length&&(h=this.getElementsInViewPort(h));s.forEach.call(h,t,s);if(n)return s;h=null;if(r){var d=VDom,f=d.dbZoom,m=d.bZoom,p=0===u.scrolled&&r!==d.UI.box;if(1!==m&&c===document){d.dbZoom=f/m;d.prepareCrop()}s.forEach.call(r.querySelectorAll(e),t,s);d.dbZoom=f;p&&(u.scrolled=0)}1===u.scrolled&&u.supressScroll();a&&this.deduplicate(s);null===this.frameNested||(a?this.checkNestedFrame(s):0<s.length?this.frameNested=null:this.checkNestedFrame());return s},getElementsInViewPort:function(e){for(var t=[],i=window.innerHeight,n=1,o=e.length;n<o;n++){var r=e[n];if(!(r instanceof HTMLFormElement)){var s=r.getBoundingClientRect();if(0<s.bottom&&s.top<i)t.push(r);else{var l=r.lastElementChild;if(l){for(;e[++n]!==l;);n--}}}}return 12<t.length?t:e},deduplicate:function(e){for(var t=e.length,i,n;0<--t;){if(4!==e[i=t][2]);else{if(7<(n=e[--t][2])||!this.isDescendant(e[i][0],e[t][0]))continue;if(VDom.isContaining(e[t][1],e[i][1])){e.splice(i,1);continue}if(n<2||0===t)continue}for(;0<t&&2<=(n=e[t-1][2])&&n<=5&&this.isDescendant(e[t][0],e[t-1][0])&&--t!=i-3;);t<i&&e.splice(t,i-t)}},isDescendant:function(e,t){for(var i=3,n,o;0<i--&&(n=e.parentNode)!==t&&n;e=n);if(n!==t)return false;for(;;){if(1!==n.childElementCount||(o=n.firstChild)instanceof Text&&o.data.trim())return false;if(2===i)break;n=n.firstElementChild;i++}return true},frameNested:false,checkNestedFrame:function(e){var t=e&&1<e.length?null:!(window.frames&&!frames.length)&&(document.webkitIsFullScreen?0:this._getNestedFrame(e));this.frameNested=false===t&&"complete"===document.readyState?null:t},_getNestedFrame:function(e){if(null==e){if(!VDom.isHTML())return false;(e=[]).forEach.call(document.querySelectorAll("a,button,input,frame,iframe"),this.GetClickable,e)}if(1!==e.length)return 0!==e.length&&null;var t,i,n=e[0][0];return(n instanceof HTMLIFrameElement||n instanceof HTMLFrameElement)&&(t=n.getClientRects()[0])&&(i=document.documentElement.getBoundingClientRect())&&t.top-i.top<20&&t.left-i.left<20&&i.right-t.right<20&&i.bottom-t.bottom<20&&"visible"===getComputedStyle(n).visibility?n:null},getVisibleElements:function(e){var t=this.mode1,i=t<128,n=132===t||133===t?this.traverse("a[href],img[src],[data-src]",this.GetImages,true):136<=t&&t<=256?this.traverse("a",this.GetLinks):this.traverse("*",258===t?this.GetEditable:this.GetClickable,258===t);this.maxLeft=e[2],this.maxTop=e[3],this.maxRight=e[4];if(0<this.maxRight){t=Math.ceil(Math.log(n.length)/Math.log(VSettings.cache.linkHintCharacters.length));this.maxLeft-=16*t+12}n.reverse();for(var o=[null,null],r=VDom.SubtractSequence.bind(o),s=null,l,u,a,c=n.length,h=Math.max(0,c-16);0<--c;){0<h&&--h;if(!(6<(a=n[c])[2])){var d=a[1];for(t=c;h<=--t;)if(!(d[3]<=(l=n[t][1])[1]||d[2]<=l[0]||l[2]<=d[0]||l[3]<=d[1]||6<n[t][2])){o[0]=[];o[1]=l;null!==s?s.forEach(r):r(d);if(0===(s=o[0]).length)break}if(null!==s){if(0<s.length)this.maxTop<(l=s[0])[1]&&d[1]<l[1]||this.maxLeft<l[0]&&d[0]<l[0]||1===s.length&&(l[3]-l[1]<3||l[2]-l[0]<3)||(a[1]=l);else if(4===(u=a[2])||(2===u?i:5===u)&&a[0].contains(n[t][0]))n.splice(c,1);else{3<a.length&&(d=a[3][0]);for(var f=c;t<=--f;)if((l=n[f][1])[0]<=d[0]&&l[1]<=d[1]&&d[0]<l[0]+10&&d[1]<l[1]+8){var m=[d,3<a.length?a[3][1]+13:13],p=n[f];3<p.length?p[3]=m:p.push(m);break}}s=null}}}return n.reverse()},onKeydown:function(e){var t,i;if(e.repeat||!this.isActive);else if(VKeyboard.isEscape(e))this.clean();else{if(27===(i=e.keyCode))return 1;if(229===i){VHints.clean(true);VHUD.showForDuration("LinkHints exits because you're inputing");return 0}if(112<i&&i<=123){this.ResetMode();if(113!==i)return 0;i=VKeyboard.getKeyStat(e);var n=VSettings.cache,o=n.deepHints;if(8===i)this.isClickListened=!this.isClickListened;else if(0===i)n.deepHints=!o;else if(2===i||91===i&&VSettings.cache.onMac){if(this.switchShadowVer()&&o)return 2;n.deepHints=true}setTimeout(this.reinit.bind(this,null),0)}else if(16===i||17===i||18===i||91===i&&VSettings.cache.onMac){var r=this.mode,s=18===i?r<256?64^((128<=r?0:2)|r):r:r<128?16===i?3^(1|r):1^(2|r):r;if(s!==r){this.setMode(s);(i=VKeyboard.getKeyStat(e))&i-1||(this.lastMode=r)}}else if(i<=40&&33<=i){VEventMode.scroll(e);this.ResetMode()}else if(32===i){false===this.zIndexes||this.rotateHints(e.shiftKey);e.shiftKey&&this.ResetMode()}else if(t=this.alphabetHints.matchHintsByKey(this.hints,e,this.keyStatus))if(0===t.length)this.deactivate(this.keyStatus.known);else if(1===t.length){VUtils.prevent(e);this.activateLink(t[0])}else{var l=this.keyStatus.tab?0:this.keyStatus.newHintLength;for(i=t.length;0<=--i;){for(var u=t[i].marker.childNodes,a=u.length;l<=--a;)u[a].classList.remove("MC");for(;0<=a;--a)u[a].classList.add("MC")}}else if(false===t){this.tooHigh=null;setTimeout(this.reinit.bind(this,null),0)}}return 2},switchShadowVer:function(){var e="* >>> ",t="* /deep/ ",i=t;if(VSettings.cache.browserVer<56);else try{(VDom.UI.box||VDom.createElement("div")).querySelector(e+"div");i=e}catch(e){}this.switchShadowVer=function(){this._shadowSign=this._shadowSign!==i?i:t;return i===t};return this.switchShadowVer()},ResetMode:function(){if(!(256<=VHints.mode||VHints.lastMode===VHints.mode)){var e=VEventMode.keydownEvents();return e[17]||e[91]||e[16]||e[18]?VHints.setMode(VHints.lastMode):void 0}},resetHints:function(){var e=this.hints,t=0,i=e?e.length:0;this.hints=this.zIndexes=null;0<this.pTimer&&clearTimeout(this.pTimer);for(;t<i;)e[t++].target=null},activateLink:function(e){var t,i=e.target;this.resetHints();var n=this.modeOpt[this.mode];VHUD.text=n;if(VDom.isInDOM(i)){t=VDom.UI.getVRect(i,e.refer);var o;if(false!==this.modeOpt.activator.call(this,i,t,e)&&(t||(t=VDom.getVisibleClientRect(i)))){var r=i instanceof HTMLIFrameElement||i instanceof HTMLFrameElement;setTimeout(function(){(r||document.hasFocus())&&VDom.UI.flash(null,t)},17)}}else{i=null;VHUD.showForDuration("The link has been removed from page",2e3)}this.pTimer=-(VHUD.text!==n);if(!(64&this.mode)){this.setupCheck(i,null);return this.deactivate(true)}this.isActive=false;this.setupCheck();setTimeout(function(){var e=VHints;e.reinit(i,t);if(1==--e.count&&e.isActive)return e.setMode(e.mode1)},18)},reinit:function(e,t){if(!VSettings.enabled)return this.clean();this.isActive=false;this.keyStatus.tab=0;this.zIndexes=null;this.resetHints();var i=this.mode<128;this.activate(0,this.options);return this.setupCheck(e,t,i)},setupCheck:function(t,i,e){this.timer&&clearTimeout(this.timer);this.timer=t&&(true===e||this.mode<128)?setTimeout(function(e){!e&&VHints&&VHints.CheckLast(t,i)},255):0},CheckLast:function(e,t){var i=VHints;if(i){i.timer=0;var n=e.getBoundingClientRect(),o=n.width<1&&n.height<1||"visible"!==getComputedStyle(e).visibility;o&&VDom.lastHovered===e&&(VDom.lastHovered=null);return t&&i.isActive&&i.hints.length<64&&!i.alphabetHints.hintKeystroke&&(o||100<Math.abs(n.left-t[0])||60<Math.abs(n.top-t[1]))?i.reinit():void 0}},clean:function(e){var t=this.keyStatus,i=this.alphabetHints;this.options=this.modeOpt=this.zIndexes=this.hints=null;0<this.pTimer&&clearTimeout(this.pTimer);this.lastMode=this.mode=this.mode1=this.count=this.pTimer=this.maxLeft=this.maxTop=this.maxRight=t.tab=t.newHintLength=i.countMax=0;i.hintKeystroke=i.chars="";this.isActive=this.noHUD=this.tooHigh=t.known=false;VUtils.remove(this);VEventMode.onWndBlur(null);if(this.box){this.box.remove();this.box=null}e||VHUD.hide()},deactivate:function(e){this.clean(this.pTimer<0);return VDom.UI.suppressTail(e)},rotateHints:function(e){var t=this.hints,i=this.zIndexes;if(!i){t.forEach(this.MakeStacks,[[],i=[]]);if((i=i.filter(function(e){return 1<e.length})).length<=0){this.zIndexes=!(this.keyStatus.newHintLength<=0)&&null;return}this.zIndexes=i}for(var n=0,o=i;n<o.length;n++){var r=o[n];e&&r.reverse();for(var s=r[r.length-1],l=t[s].zIndex||s,u=0,a=r;u<a.length;u++){var c=a[u],h=t[c],d,f=h.zIndex||c;h.marker.style.zIndex=h.zIndex=l;l=f}e&&r.reverse()}},MakeStacks:function(e,t){var i=this[0];if("hidden"!==e.marker.style.visibility){var n=this[1],o=e.marker.getClientRects()[0];i.push(o);for(var r=null,s=0,l=n.length;s<l;){for(var u=n[s],a=0,c=u.length;a<c;a++){var h=i[u[a]];if(h.top<o.bottom&&o.top<h.bottom&&h.left<o.right&&o.left<h.right)break}if(c<=a);else{if(r){r.push.apply(r,u);n.splice(s,1);l--;continue}u.push(t);r=u}s++}r||n.push([t])}else i.push(null)},unhoverLast:function(){VDom.hover(null);return VHUD.showForDuration("The last element is unhovered")},alphabetHints:{chars:"",hintKeystroke:"",countMax:0,countLimit:0,numberToHintString:function(e){var t=this.chars,i=t.length,n="";do{var o=e%i;e=e/i|0;n=t[o]+n}while(0<e);0<(e=this.countMax-n.length-+(e<this.countLimit))&&(n=this.repeat(t[0],e)+n);return n},initMarkers:function(e,t){this.chars=t.toUpperCase();this.hintKeystroke="";for(var i=e.length,n=this.buildHintIndexes(i),o=0;o<i;o++)for(var r=e[o],s=r.key=this.numberToHintString(n[o]),l=0,u=s.length;l<u;l++){var a=document.createElement("span");a.textContent=s[l];r.marker.appendChild(a)}this.countMax-=0<this.countLimit;this.countLimit=0},buildHintIndexes:function(e){var t=[],i=[],n=this.chars.length,o=e,r=o%n,s=this.countMax=Math.ceil(Math.log(o)/Math.log(n)),l=o-r+n,u=this.countLimit=(Math.pow(n,s)-o)/(n-1)|0;for(s=0;s<u;s++)t.push(s);for(u*=n-1;s<o;s++)t.push(s+u);for(s=0;s<n;s++){s===r&&(l-=n);for(var a=s;a<l;a+=n)i.push(t[a])}return i},matchHintsByKey:function(e,t,i){var n,o=t.keyCode,r=null;if(9===o){if(!this.hintKeystroke)return false;i.tab=1-i.tab}else if(i.tab){this.hintKeystroke="";i.tab=0}i.known=true;if(9===o);else if(8===o||46===o||112===o){if(!this.hintKeystroke)return[];this.hintKeystroke=this.hintKeystroke.slice(0,-1)}else{if(!(n=VKeyboard.getKeyChar(t).toUpperCase())||1!==n.length)return null;if(-1===this.chars.indexOf(n))return[];this.hintKeystroke+=n;r=[]}i.newHintLength=(n=this.hintKeystroke).length;i.known=false;VHints.zIndexes&&(VHints.zIndexes=null);var s=!i.tab;if(null!==r&&this.countMax<=n.length){e.some(function(e){return e.key===n&&(r.push(e),true)});if(1===r.length)return r}return e.filter(function(e){var t=e.key.startsWith(n)===s;e.marker.style.visibility=t?"":"hidden";return t})},repeat:function(e,t){if(e.repeat)return e.repeat(t);for(var i=e;--t;)i+=e;return i}},getUrlData:function(e){var t=e.getAttribute("data-vim-url");t&&((e=VDom.createElement("a")).href=t.trim());return e.href},getImageUrl:function(e){var t=e instanceof HTMLImageElement,i=t?e.src:e instanceof HTMLAnchorElement?e.href:"",n=e.getAttribute("data-src")||"";(!i||i.startsWith("data:")||VUtils.jsRe.test(i)||i.length+7<n.length&&(t||VUtils.isImageUrl(n)))&&(i=n);return i||VHUD.showForDuration("Not an image",1e3)},openUrl:function(e,t){var i=this.options.keyword,n={handler:"openUrl",reuse:64&this.mode?-2:-1,url:e,keyword:null!=i?i+"":""};t&&(n.incognito=t);VPort.post(n)},highlightChild:function(t){var e=true,i=null;try{e=!t.contentDocument||(i=t.contentWindow).VEventMode.keydownEvents(VEventMode.keydownEvents())}catch(e){}var n=this,o=n.count,r=n.options;r.mode=this.mode;t.focus();if(!e){i.VHints.activateAndFocus(o,r);return false}VPort.send({handler:"execInChild",url:t.src,CSS:"1",command:"Hints.activateAndFocus",count:o,options:r},function(e){e||t.contentWindow.focus()})},Modes:{HOVER:{128:"Hover over node",192:"Hover over nodes continuously",activator:function(e,t){var i=VDom.getEditableType(e);VDom.hover(VScroller.current=e,t);i||e.tabIndex<0||e instanceof HTMLIFrameElement||e instanceof HTMLFrameElement||e.focus();if(this.mode<128)return VHUD.showForDuration("Hover for scrolling",1e3)}},LEAVE:{129:"Simulate mouse leaving link",193:"Simulate mouse leaving continuously",activator:function(e){var t=VDom.lastHovered===e;VDom.hover(null);t||VDom.mouse(e,"mouseout");document.activeElement===e&&e.blur()}},COPY_TEXT:{130:"Copy link text to Clipboard",131:"Search selected text",137:"Copy link URL to Clipboard",194:"Copy link text one by one",195:"Search link text one by one",201:"Copy link URL one by one",256:"Edit link URL on Vomnibar",257:"Edit link text on Vomnibar",activator:function(e){var t=136<=this.mode1&&this.mode1<=256,i;if(t)(i=this.getUrlData(e))&&i.startsWith("mailto:")&&7<i.length&&(i=i.substring(7).trimLeft());else if((i=e.getAttribute("data-vim-text"))&&(i=i.trim()));else if(e instanceof HTMLInputElement){if("password"===(i=e.type))return VHUD.showForDuration("Sorry, Vimium C won't copy a password.",2e3);i=i in VDom.uneditableInputs?"file"===i?e.files&&0<e.files.length?e.files[0].name:"":0<="button image submit reset".indexOf(i)&&e.value.trim()||e.title.trim():(e.value||e.placeholder).trim()}else i=(i=e instanceof HTMLTextAreaElement?e.value:e instanceof HTMLSelectElement?e.selectedIndex<0?"":e.options[e.selectedIndex].text:e instanceof HTMLElement&&((i=e.innerText.trim()).startsWith("mailto:")&&7<i.length?i.substring(7).trimLeft():i)||(i=e.textContent.trim())&&i.replace(/\s+/g," ")).trim()||(e instanceof HTMLElement?e.title.trim():"");if(!i)return VHUD.showCopied("",t?"url":"");if(256<=this.mode&&this.mode<=257){var n=this.options.force;VPort.post({handler:"activateVomnibar",count:1,force:null!=n?!!n:!t,url:i,keyword:(this.options.keyword||"")+""})}else if(131!==this.mode1){i=t?VUtils.decodeURL(i):i;VPort.post({handler:"copy",data:i});VHUD.showCopied(i)}else this.openUrl(i)}},OPEN_INCOGNITO_LINK:{138:"Open link in incognito window",202:"Open multi incognito tabs",activator:function(e){var t=this.getUrlData(e);if(!VPort.evalIfOK(t))return this.openUrl(t,true)}},DOWNLOAD_IMAGE:{132:"Download image",196:"Download multiple images",activator:function(e){var t=this.getImageUrl(e);if(t){var i=t.indexOf("://"),n=VDom.createElement("a");0<i&&(t=t.substring(t.indexOf("/",i+4)+1));40<t.length&&(t=t.substring(0,39)+"\u2026");n.href=e.src;n.download=e.getAttribute("download")||"";VDom.mouse(n,"click",null);return VHUD.showForDuration("Download: "+t,2e3)}}},OPEN_IMAGE:{133:"Open image",197:"Open multiple image",activator:function(e){var t=this.getImageUrl(e),i,n;if(t){i="vimium://show image ";(n=e.getAttribute("download"))&&(i+="download="+encodeURIComponent(n)+"&");this.openUrl(i+t)}}},DOWNLOAD_LINK:{136:"Download link",200:"Download multiple links",activator:function(e,t){var i,n,o=false;if((!(n=e.getAttribute("href"))||"#"===n)&&(i=e.getAttribute("data-vim-url"))&&(i=i.trim())){e.href=i;o=true}null==(i=e.getAttribute("download"))&&(e.download="");VDom.UI.click(e,t,{altKey:true,ctrlKey:false,metaKey:false,shiftKey:false});null===i&&e.removeAttribute("download");o&&("string"==typeof n?e.setAttribute("href",n):null===n&&e.removeAttribute("href"))}},FOCUS_EDITABLE:{134:"Focus node",198:"Focus nodes continuously",258:"Select an editable area",activator:function(e,t){if(this.mode<256){VDom.ensureInView(e);e.focus();VDom.UI.flash(e)}else VDom.UI.simulateSelect(e,t,true);return false}},DEFAULT:{0:"Open link in current tab",2:"Open link in new tab",3:"Open link in new active tab",64:"Open multiple links in current tab",66:"Open multiple links in new tabs",67:"Activate link and hold on",activator:function(e,t,i){if(e instanceof HTMLIFrameElement||e instanceof HTMLFrameElement){var n=e===Vomnibar.box?(Vomnibar.focus(),false):this.highlightChild(e);this.mode=0;return n}if("function"==typeof HTMLDetailsElement?e instanceof HTMLDetailsElement:"DETAILS"===e.tagName.toUpperCase()){var o=e.open;VDom.UI.click(e,t,null,true);e.open===o&&(e.open=!o)}else{if(i.scroll)return this.Modes.HOVER.activator.call(this,e,t,i);if(3<=VDom.getEditableType(e)){VDom.UI.simulateSelect(e,t,true);return false}var r=3&this.mode,s=VSettings.cache.onMac,l=2<=r;VDom.UI.click(e,t,{altKey:false,ctrlKey:l&&!s,metaKey:l&&s,shiftKey:3===r},0!==r||0<=e.tabIndex)}}}}},Vomnibar={box:null,port:null,status:-1,options:null,onReset:null,timer:0,screenHeight:0,maxBoxHeight:0,defaultTop:"",top:"",activate:function(e,t){if(-2===this.status)return VHUD.showForDuration("Sorry, Vomnibar page seems to fail to load.",2e3);if(t&&t.secret&&t.vomnibar)if("loading"!==document.readyState||this.timer){this.timer=0;if(VDom.isHTML()){true!==t.url&&1===e||window.top!==window&&t.topUrl&&"string"==typeof t.topUrl||(t.topUrl=window.location.href);this.options=null;VDom.dbZoom=1;var i=VDom.prepareCrop(),n=this.screenHeight=window.innerHeight;t.width=i,t.height=n;VDom.getZoom();0<this.status||VUtils.push(VDom.UI.SuppressMost,this);this.box&&VDom.UI.adjust();if(-1===this.status){if(VHints.tryNestedFrame("Vomnibar.activate",e,t))return VUtils.remove(this);this.status=1;this.init(t)}else{if(this.isABlank()){this.onReset=function(){this.onReset=null;return this.activate(e,t)};return}if(0===this.status)this.status=2;else if(2<this.status){this.focus();this.status=2}}t.secret=0;t.vomnibar=t.vomnibar2=t.CSS="";t.name="activate";var o=t.url,r=0;if(true===o){(o=VDom.UI.getSelectionText())?t.force=true:o=t.topUrl;r=1<e?1-e:e<0?-e:0;t.url=o}else if(null!=o)o=t.url="string"==typeof o?o:null;else if(1!==e){o=t.url=t.topUrl;r=1<e?1-e:-e}t.topUrl="";if(!o||-1===o.indexOf("://")){t.search="";return this.setOptions(t)}window.shownNode&&!window.VimiumInjector&&(o=o.split("#",1)[0]+window.name);var s=t.trailing_slash;return VPort.send({handler:"parseSearchUrl",trailing_slash:null!=s?!!s:null,upper:r,url:o},function(e){null!=(t.search=e)&&(t.url="");return Vomnibar.setOptions(t)})}}else this.timer=setTimeout(this.activate.bind(this,e,t),500)},setOptions:function(e){1<this.status?this.port.postMessage(e):this.options=e},hide:function(e){var t=0<this.status;this.status=0;this.screenHeight=0;this.defaultTop="";if(null!=e){VUtils.remove(this);t||window.focus();this.box.style.cssText="display: none;"}else t&&this.port.postMessage("hide")},init:function(e){function s(){a=0;i.removeAttribute("referrerPolicy");i.removeAttribute("sandbox");i.src=u=c;c=null;var e=Vomnibar.options;e&&(e.ptype=a)}var l=e.secret,u=e.vomnibar,a=e.ptype,c=e.vomnibar2,t=e.CSS,i=VDom.createElement("iframe"),n=VDom.UI;i.className="R UI Omnibar";if(2!==a);else if(u.startsWith("http:")&&location.origin.startsWith("https:"))s();else{i.referrerPolicy="no-referrer";i.sandbox="allow-scripts"}i.src=u;i.style.visibility="hidden";var h=false;i.onload=function(){var e=Vomnibar;h=true;if(!e.onReset){if(0!==a&&e.isABlank()){console.log("Vimium C: use built-in Vomnibar page because the preferred is too old.");return s()}var t=this.contentWindow,i=[l,e.options],n=u.substring(0,u.startsWith("file:")?7:u.indexOf("/",u.indexOf("://")+3));c||VSettings.cache.browserVer<49?setTimeout(function(e){var t=Vomnibar,i;if(!(!t||1!==t.status||e)){if(0!==a)return s();t.reset();VDom.UI.box.style.display="";window.focus();t.status=-2;return t.activate()}t&&t.box&&(t.box.onload=t.options=null)},1e3):this.onload=null;if(location.origin===n&&n.startsWith("chrome")){if(!(t.Vomnibar&&t.onmessage))return s();var o={sameOrigin:true,onmessage:null,postMessage:function(e){return Vomnibar&&Vomnibar.onMessage({data:e})}};e.port={close:function(){o.postMessage=function(){}},postMessage:function(e){return o.onmessage({data:e})}};"#chrome-ui"!==location.hash||window.VimiumInjector||(e.top="8px");t.onmessage({source:window,data:i,ports:[o]})}else{var r=new MessageChannel;e.port=r.port1;r.port1.onmessage=e.onMessage.bind(e);t.postMessage(i,2!==a?n:"*",[r.port2])}}};t&&n.css("");n.addElement(this.box=i,3,VHUD.box);t&&n.css(t);0!==a&&setTimeout(function(e){h||e||Vomnibar.onReset||s()},2e3)},reset:function(e){if(-1!==this.status){var t=this.status;this.status=-1;this.port.close();this.box.remove();this.port=this.box=null;this.defaultTop="";VUtils.remove(this);this.options=null;if(this.onReset)return this.onReset();if(e&&!(t<2))return VPort.post({handler:"activateVomnibar",redo:true,inner:true})}},isABlank:function(){try{var e=this.box.contentDocument;if(e&&"about:blank"===e.URL)return true}catch(e){}return false},onMessage:function(e){var t=e.data;switch(t.name){case"uiComponentIsReady":this.status=2;var i=this.options;if(i){this.options=null;return this.port.postMessage(i)}break;case"style":this.box.style.height=t.height/VDom.wdZoom+"px";if(1===this.status||2===this.status){this.maxBoxHeight=t.max;this.onShown()}break;case"focus":window.focus();return VEventMode.suppress(t.key);case"hide":return this.hide(1);case"test":return VEventMode.OnWndFocus();case"scroll":return VEventMode.scroll(t);case"scrollGoing":VScroller.keyIsDown=VScroller.maxInterval;break;case"scrollEnd":VScroller.keyIsDown=0;break;case"evalJS":VPort.evalIfOK(t.url);break;case"broken":t.active&&window.focus();case"unload":return Vomnibar?this.reset("broken"===t.name):void 0;case"hud":VHUD.showForDuration(t.text);return;default:console.log('[%d] Vimium C: unknown message "%s" from Vomnibar page',Date.now(),t.name)}},onShown:function(){this.status=3;var e=this.box.style,t=this.maxBoxHeight;if(0<t){var i=this.screenHeight,n=.6*t|0,o;this.defaultTop=2*(64+n)<i?50-n/i*100+"%":""}e.top=1!==VDom.wdZoom?(64/VDom.wdZoom|0)+"px":this.top||this.defaultTop;if(e.visibility){e.visibility="";var r=VDom.UI.box;r.hasAttribute("style")&&r.removeAttribute("style")}else e.display="";VUtils.remove(this);return VUtils.push(this.onKeydown,this)},onKeydown:function(e){if(VEventMode.lock())return 0;if(VKeyboard.isEscape(e)){this.hide();return 2}var t=e.keyCode-112;if(0!==t&&1!==t)return 0;this.focus();return 2},focus:function(){if(!(this.status<3))return this.port.postMessage("focus")}},VScroller={animate:function(e,t,i){function r(e){var t=d,i,n;d=e;if(-1!==t){t=m+=i=0<(i=e-t)?i:17;var o=VScroller;if((n=0<o.keyIsDown)&&75<=t){o.minDelay<t&&--o.keyIsDown;.5<=(t=l)&&t<=1.6&&(l*=1.05<(t=150/s/t)?1.05:t<.95?.95:1)}t=Math.ceil(s*(i/a)*l);n||(t=Math.min(t,s-f));if(!(0<t&&o.performScroll(c,u,h*t))){o.checkCurrent(c);c=null;p=0;return}f+=t}requestAnimationFrame(r)}var s=0,l=1,u=0,a=0,c=null,h=0,d=-1,f=0,m=0,p=0;this.animate=function(e,t,i){s=Math.abs(i);l=1;u=t;a=Math.max(100,20*Math.log(s));c=e;h=i<0?-1:1;d=-1;f=m=0;var n=VSettings.cache.keyboard;this.maxInterval=Math.round(n[1]/16.67)+4;this.minDelay=30*((n[0]-n[1])/30|0);this.keyIsDown=this.maxInterval;if(!p){p=1;return requestAnimationFrame(r)}};return this.animate(e,t,i)},maxInterval:28,minDelay:600,performScroll:function(e,t,i){var n;if(t){if(e){n=e.scrollTop;e.scrollBy?e.scrollBy({behavior:"instant",top:i}):e.scrollTop+=i;return e.scrollTop!==n}n=window.scrollY;VDom.scrollWndBy(0,i);return window.scrollY!==n}if(e){n=e.scrollLeft;e.scrollBy?e.scrollBy({behavior:"instant",left:i}):e.scrollLeft+=i;return e.scrollLeft!==n}n=window.scrollX;VDom.scrollWndBy(i,0);return window.scrollX!==n},scroll:function(e,t,i){if(i){if(VSettings.cache.smoothScroll&&VDom.allowRAF)return this.animate(e,t,i);this.performScroll(e,t,i);return this.checkCurrent(e)}},current:null,top:null,keyIsDown:0,scale:1,Properties:["clientWidth","clientHeight","scrollWidth","scrollHeight","scrollLeft","scrollTop"],ScBy:function(e,t){if(!VHints.tryNestedFrame("VScroller.ScBy",e,t))return VScroller.scrollBy("x"===t.axis?0:1,(+t.dir||1)*e,t.view)},scrollBy:function(e,t,i){VMarks.setPreviousPosition();this.prepareTop();var n=this.findScrollable(e,t);t=i?1===i?(0<t?Math.ceil:Math.floor)(t):t*this.getDimension(n,e,"max"===i?2:0):this.adjustAmount(e,t,n);this.scroll(n,e,t);this.top=null},ScTo:function(e,t){if(!VHints.tryNestedFrame("VScroller.ScTo",e,t)){var i="max"===t.dest?1:0;if(e<0){i=1-i;e=-e}return VScroller.scrollTo("x"===t.axis?0:1,e-1,i)}},scrollTo:function(e,t,i){this.prepareTop();var n=this.findScrollable(e,i?1:-1);t=this.adjustAmount(e,t,n);i&&(t=this.getDimension(n,e,2)-t-this.getDimension(n,e,0));t-=n?n[this.Properties[4+e]]:e?window.scrollY:window.scrollX;this.scroll(n,e,t);this.top=null},adjustAmount:function(e,t,i){t*=VSettings.cache.scrollStepSize;return!e&&t&&i&&i.scrollWidth<=2*i.scrollHeight?Math.ceil(.6*t):t},findScrollable:function(e,t){var i=this.current;if(!i)return this.current=(i=this.top)&&(this.selectFirst(i)||i);for(;i!==this.top&&!this.shouldScroll(i,e,t);)i=VDom.getParent(i)||this.top;return i},prepareTop:function(){this.top=VDom.scrollingEl()||(VDom.isHTML()?document.documentElement:null);if(this.top){VDom.getZoom(1);this.getScale()}},getScale:function(){this.scale=1/Math.min(1,VDom.wdZoom)/Math.min(1,VDom.bZoom)},checkCurrent:function(e){var t=this.current;t!==e&&t&&VDom.NotVisible(t)&&(this.current=e)},getDimension:function(e,t,i){return e!==this.top||i&&e?(e||this.top)[this.Properties[i+t]]:t?window.innerHeight:window.innerWidth},scrollDo:function(e,t,i){var n=this.Properties[4+t],o=e[n],r=t?"top":"left",s={behavior:"instant"};s[r]=(0<i?1:-1)*this.scale;e.scrollBy?e.scrollBy(s):e[n]+=s[r];var l=e[n]!==o;if(l){e.scrollTo?(s[r]=o,e.scrollTo(s)):e[n]=o;0===this.scrolled&&(this.scrolled=1)}return l},selectFirst:function(e,t){if(e.clientHeight+3<e.scrollHeight&&(this.scrollDo(e,1,1)||0<e.scrollTop&&this.scrollDo(e,1,0))){this.scrolled=0;return e}t||VDom.prepareCrop();for(var i=[],n=e.children,o=n.length;0<o--;)if(!((e=n[o])instanceof HTMLFormElement)){var r=e.getBoundingClientRect(),s=0<r.height?VDom.cropRectToVisible(r.left,r.top,r.right,r.bottom):VDom.getVisibleClientRect(e);s&&i.push({area:(s[2]-s[0])*(s[3]-s[1]),el:e})}i.sort(this.sortByArea);for(o=i.length;0<o--;)if(e=this.selectFirst(i[o].el,1))return e;return null},scrollIntoView:function(e){var t=e.getClientRects()[0];if(t){this.prepareTop();this.current=e;var i=window.innerWidth,n=window.innerHeight,o=t.bottom,r=t.height,s=t.top,l=t.right,u=t.width,a=t.left,c=o<0?o-Math.min(r,n):n<s?s+Math.min(r-n,0):0,h=l<0?l-Math.min(u,i):i<a?a+Math.min(u-i,0):0;h&&(c?this.performScroll:this.scroll).call(this,this.findScrollable(0,h),0,h);c&&this.scroll(this.findScrollable(1,c),1,c);this.keyIsDown=0;this.top=null}},scrolled:0,shouldScroll:function(e,t,i){var n=getComputedStyle(e);return"hidden"!==(t?n.overflowY:n.overflowX)&&"none"!==n.display&&"visible"===n.visibility&&this.scrollDo(e,t,null!=i?i:+!(t?e.scrollTop:e.scrollLeft))},supressScroll:function(){if(VDom.allowRAF){this.scrolled=2;VUtils.suppressAll(window,"scroll");requestAnimationFrame(function(){VScroller.scrolled=0;VUtils.suppressAll(window,"scroll",true)})}else this.scrolled=0},sortByArea:function(e,t){return e.area-t.area}},VMarks={onKeyChar:null,prefix:true,swap:true,activate:function(e,t){var i="create"!==t.mode;this.onKeyChar=i?this._goto:this._create;this.prefix=false!==t.prefix;this.swap=true===t.swap;VUtils.push(this.onKeydown,this);return VHUD.show(i?"Go to mark\u2026":"Create mark\u2026")},onKeydown:function(e){var t=e.keyCode,i=!VKeyboard.isEscape(e),n;if(i&&(112<t&&t<132||t<33||!(n=VKeyboard.getKeyChar(e))||1!==n.length))return 1;VUtils.remove(this);i&&32<t?this.onKeyChar(e,n):VHUD.hide();this.prefix=this.swap=true;this.onKeyChar=null;return 2},getLocationKey:function(e){return"vimiumMark|"+location.href.split("#",1)[0]+"|"+e},_previous:null,setPreviousPosition:function(){this._previous=[window.scrollX,window.scrollY,location.hash]},_create:function(e,t){if("`"===t||"'"===t){this.setPreviousPosition();return VHUD.showForDuration("Created local mark [last].",1e3)}if(e.shiftKey===this.swap)return this.createMark(t,"local");if(window.top===window)return this.createMark(t);VPort.post({handler:"marks",action:"create",markName:t});return VHUD.hide()},_goto:function(e,t){if("`"===t||"'"===t){var i=this._previous;this.setPreviousPosition();i&&this._scroll(i);return VHUD.showForDuration((i?"Jumped to":"Created")+" local mark [last]",1e3)}var n={handler:"marks",action:"goto",prefix:this.prefix,markName:t};if(e.shiftKey!==this.swap)VHUD.hide();else{try{var i=null,o=this.getLocationKey(t),r=localStorage.getItem(o);if(r&&(i=JSON.parse(r))&&"object"==typeof i){var s=VUtils.safer(i),l=s.scrollX,u=s.scrollY,a;if(0<=l&&0<=u){n.old={scrollX:0|l,scrollY:0|u,hash:""+(s.hash||"")};localStorage.removeItem(o)}}}catch(e){}n.local=true;n.url=location.href}VPort.post(n)},_scroll:function(e){0===e[1]&&e[2]&&0===e[0]?location.hash=e[2]:window.scrollTo(e[0],e[1])},createMark:function(e,t){VPort.post({handler:"marks",action:"create",local:!!t,markName:e,url:location.href,scroll:[0|window.scrollX,0|window.scrollY]});return VHUD.showForDuration("Created "+(t||"global")+" mark : ' "+e+" '.",1e3)},goTo:function(e,t){var i=t.scroll,n=t.local,o=t.markName;o&&this.setPreviousPosition();this._scroll(i);n||VEventMode.focusAndListen();if(o)return VHUD.showForDuration("Jumped to "+(n?"local":"global")+" mark : ' "+o+" '.",n?1e3:2e3)}},VFindMode={isActive:false,query:"",query0:"",parsedQuery:"",parsedRegexp:null,historyIndex:0,notEmpty:false,isRegex:null,ignoreCase:null,wholeWord:false,hasResults:false,matchCount:0,coords:null,initialRange:null,activeRegexIndex:0,regexMatches:null,box:null,input:null,countEl:null,styleIn:null,styleOut:null,A0Re:/\xa0/g,tailRe:/\n$/,cssSel:"::selection { background: #ff9632 !important; }",cssIFrame:'*{font:12px/14px "Helvetica Neue",Helvetica,Arial,sans-serif!important;\nheight:14px;margin:0;overflow:hidden;vertical-align:top;white-space:nowrap;cursor:default;}\nbody{cursor:text;display:inline-block;padding:0 3px 0 1px;max-width:215px;min-width:7px;}\nbody *{all:inherit!important;display:inline!important;}html>count{float:right;}',activate:function(e,t){if(VDom.isHTML()){var i=(t.query||"")+"",n=VDom.UI,o=!n.box;this.isActive||i===this.query&&t.leave||VMarks.setPreviousPosition();VDom.docSelectable=n.getDocSelectable();n.ensureBorder();if(t.leave)return this.findAndFocus(i||this.query,t);this.getCurrentRange();t.returnToViewport&&(this.coords=[window.scrollX,window.scrollY]);this.box&&n.adjust();VHUD.hide(-2);if(this.isActive)return this.setFirstQuery(i);this.parsedQuery=this.query="";this.parsedRegexp=this.regexMatches=null;this.activeRegexIndex=0;var r=this.box=VDom.createElement("iframe");r.className="R HUD UI";r.style.width="0px";1!==VDom.wdZoom&&(r.style.zoom=""+1/VDom.wdZoom);r.onload=function(){return VFindMode.onLoad(this,1)};VUtils.push(n.SuppressMost,this);this.query||(this.query0=i);this.init&&this.init(0);i||(this.styleIn.disabled=this.styleOut.disabled=true);n.toggleSelectStyle(true);n.addElement(r,o?0:2,VHUD.box);o&&n.adjust();this.isActive=true}},onLoad:function(e,t){function i(){if(VFindMode.isActive&&Date.now()-r<500){var e=this.document.body;e&&setTimeout(function(){e.focus()},17*u++)}else this.removeEventListener("blur",i,true)}var n=e.contentWindow,o=n.addEventListener.bind(n),r=Date.now(),s=VUtils.Stop,l=true,u=0;o("mousedown",this.OnMousedown,l);o("keydown",this.onKeydown.bind(this),l);o("input",this.onInput.bind(this),l);o("paste",this.OnPaste,l);o("keypress",s,l);o("keyup",s,l);o("mouseup",s,l);o("click",s,l);o("contextmenu",s,l);o("copy",s,l);o("cut",s,l);o("paste",s,l);o("focus",this.OnFocus,l);o("blur",i,l);e.onload=t?null:function(){this.onload=null;VFindMode.onLoad2(this.contentWindow)};if(t)return this.onLoad2(n)},onLoad2:function(e){function t(){var e=VFindMode;VUtils.remove(e);o.focus();return e.setFirstQuery(e.query0)}var i=e.document,n=i.documentElement,o=this.input=i.body,r=e.devicePixelRatio;e.dispatchEvent(new Event("unload"));e.onunload=VFindMode.OnUnload;var s=true;try{o.contentEditable="plaintext-only"}catch(e){s=false;o.contentEditable="true"}e.removeEventListener("paste",s?this.OnPaste:VUtils.Stop,true);var l=this.countEl=i.createElement("count");l.appendChild(i.createTextNode(""));r<1&&(n.style.zoom=""+1/r);i.head.appendChild(VDom.UI.createStyle(VFindMode.cssIFrame,i));n.insertBefore(i.createTextNode("/"),o);n.appendChild(l);if(!VDom.UI.box.style.display)return t();VDom.UI.callback=t},_actived:false,OnFocus:function(e){VFindMode._actived&&e.target===this&&VEventMode.OnWndFocus();return VUtils.Stop(e)},setFirstQuery:function(e){var t=this.box.contentWindow;this._actived=false;t.focus();this.query0="";this.query||this.SetQuery(e);this.input.focus();this.query&&t.document.execCommand("selectAll",false);this._actived=true},init:function(e){var t=this.postMode,i=VDom.UI,n=this.cssSel,o=this.styleIn=i.createStyle(n);t.exit=t.exit.bind(t);i.addElement(o,e,true);this.styleOut=i.box!==i.root?i.box.appendChild(i.createStyle(n)):o;this.init=null},findAndFocus:function(e,t){if(!e)return VHUD.showForDuration("No old queries");if(e!==this.query){this.updateQuery(e);if(this.isActive){this.input.textContent=e.replace(/^ /,"\xa0");this.showCount()}}this.init&&this.init(2);var i=this.isActive||1!==VHUD.opacity?null:VHUD.box.style;i&&(i.visibility="hidden");VDom.UI.toggleSelectStyle(true);this.execute(null,t);i&&(i.visibility="");if(this.hasResults){this.focusFoundLink(window.getSelection().anchorNode);return this.postMode.activate()}if(!this.isActive){VDom.UI.toggleSelectStyle(false);VHUD.showForDuration("No matches for '"+this.query+"'")}},clean:function(e){var t=null;this.coords&&window.scrollTo(this.coords[0],this.coords[1]);this.isActive=this._small=this._actived=this.notEmpty=false;if(3!==e&&2!==e){window.focus();(t=VDom.getSelectionFocusElement())&&t.focus&&t.focus()}this.box.remove();this.box===VDom.lastHovered&&(VDom.lastHovered=null);this.parsedQuery=this.query=this.query0="";this.historyIndex=this.matchCount=0;this.box=this.input=this.countEl=this.parsedRegexp=this.initialRange=this.regexMatches=this.coords=null;return t},OnUnload:function(e){var t=VFindMode;false!==e.isTrusted&&VFindMode&&VFindMode.box&&e.target===VFindMode.box.contentWindow&&VFindMode.isActive&&VFindMode.deactivate(3)},OnMousedown:function(e){if(e.target!==VFindMode.input&&false!==e.isTrusted){VUtils.prevent(e);VFindMode.input.focus()}},OnPaste:function(e){var t=e.clipboardData,i=t&&"function"==typeof t.getData?t.getData("text/plain"):"";VUtils.prevent(e);i&&e.target.ownerDocument.execCommand("insertText",false,i+"")},onKeydown:function(e){VUtils.Stop(e);if(!(false===e.isTrusted||VScroller.keyIsDown&&VEventMode.OnScrolls[0](e))){var t=e.keyCode,i=e.altKey?0:13===t?e.shiftKey?-1:(this.saveQuery(),4):8!==t&&46!==t?0:this.query||46===t&&!VSettings.cache.onMac||e.repeat?-1:1;if(i){if(-1===i)return}else if(VKeyboard.isEscape(e))i=5;else if(i=VKeyboard.getKeyStat(e)){if(-7&i)return;if(38===t||40===t||35===t||36===t)VEventMode.scroll(e,this.box.contentWindow);else{if(74!==t&&75!==t)return;this.execute(null,{count:75-t||-1})}i=0}else if(112===t)this.box.contentDocument.execCommand("delete");else if(113===t){window.focus();VEventMode.suppress(t)}else{if(38!==t&&40!==t)return;this.nextQuery(38!==t)}VUtils.prevent(e);if(i){VEventMode.suppress(t);return this.deactivate(i)}}},deactivate:function(e){var t=!this.styleIn.disabled,i=this.clean(e),n;if((5===e||!this.hasResults||VVisualMode.mode)&&t){this.toggleStyle(0);this.restoreSelection(true)}if(VVisualMode.mode)return VVisualMode.activate(1,VUtils.safer({from_find:true}));VDom.UI.toggleSelectStyle(false);if(!(e<4)&&this.hasResults){if((!i||i!==VEventMode.lock())&&(i=window.getSelection().anchorNode)&&!this.focusFoundLink(i)&&5===e&&(n=document.activeElement)&&3<=VDom.getEditableType(n)&&i.contains(n)){VDom.prepareCrop();VDom.UI.simulateSelect(n)}return 4===e?this.postMode.activate():void 0}},focusFoundLink:function(e){for(;e&&e!==document.body;e=e.parentElement)if(e instanceof HTMLAnchorElement){e.focus();return true}return false},nextQuery:function(e){var t=this.historyIndex+(e?-1:1);if(!(t<0)){this.historyIndex=t;if(!e)return VPort.send({handler:"findQuery",index:t},this.SetQuery);var i=this.box.contentWindow;i.document.execCommand("undo",false);i.getSelection().collapseToEnd()}},SetQuery:function(e){var t=VFindMode,i;if(e!==t.query&&(i=t.box.contentDocument)){if(e||!(0<t.historyIndex)){i.execCommand("selectAll",false);i.execCommand("insertText",false,e.replace(/^ /,"\xa0"));return t.onInput()}--t.historyIndex}},saveQuery:function(){return this.query&&VPort.post({handler:"findQuery",query:this.query})},postMode:{lock:null,activate:function(){var e=VEventMode.lock(),t=this.exit;if(e){VUtils.push(this.onKeydown,this);if(e!==this.lock){if(!this.lock){addEventListener("click",t,true);VEventMode.setupSuppress(t)}t(true);(this.lock=e).addEventListener("blur",t,true)}}else t()},onKeydown:function(e){var t=VKeyboard.isEscape(e);t?this.exit():VUtils.remove(this);return t?2:0},exit:function(e){if(!(e instanceof MouseEvent&&false===e.isTrusted)){this.lock&&this.lock.removeEventListener("blur",this.exit,true);if(this.lock&&true!==e){this.lock=null;removeEventListener("click",this.exit,true);VUtils.remove(this);return VEventMode.setupSuppress()}}}},onInput:function(e){if(null!=e){VUtils.Stop(e);if(false===e.isTrusted)return}var t=this.input.innerText.replace(this.A0Re," ").replace(this.tailRe,""),i=this.query;if(!(!this.hasResults&&!this.isRegex&&this.notEmpty&&t.startsWith(i)&&t.substring(i.length-1).indexOf("\\")<0)){i="";this.coords&&window.scrollTo(this.coords[0],this.coords[1]);this.updateQuery(t);this.restoreSelection();this.execute(this.isRegex?this.regexMatches?this.regexMatches[0]:"":this.parsedQuery);return this.showCount()}},_small:false,showCount:function(){var e=this.matchCount;this.countEl.firstChild.data=this.parsedQuery?"("+(e||(this.hasResults?"Some":"No"))+" match"+(1!==e?"es)":")"):"";e=this.input.offsetWidth+this.countEl.offsetWidth+4;this._small&&e<150||(this.box.style.width=((this._small=e<150)?0:e)+"px")},_ctrlRe:/\\[CIRW\\cirw]/g,_bslashRe:/\\\\/g,escapeAllRe:/[$()*+.?\[\\\]\^{|}]/g,updateQuery:function(e){var t=this;t.query=e;t.wholeWord=false;t.isRegex=t.ignoreCase=null;e=e.replace(t._ctrlRe,t.FormatQuery);var i=0===VSettings.cache.browser,n=t.isRegex,o=t.wholeWord,r="\\b";if(null===n&&!o){n=VSettings.cache.regexFindMode;var s=2*+e.startsWith(r)+ +e.endsWith(r);if(3===s&&!n&&3<e.length){e=e.slice(2,-2);o=true}else s&&s<3&&(n=true)}n=n||false;if(o&&(n||!i)){e=r+e.replace(t._bslashRe,"\\").replace(t.escapeAllRe,"\\$&")+r;o=false;n=true}e=n?"\\b\\b"!==e&&e!==r?e:"":e.replace(t._bslashRe,"\\");t.parsedQuery=e;t.isRegex=n;t.wholeWord=o;t.notEmpty=!!e;null!==t.ignoreCase||(t.ignoreCase=!VUtils.hasUpperCase(e));n||(e=t.isActive?e.replace(t.escapeAllRe,"\\$&"):"");var l=null;if(e)try{l=new RegExp(o?r+e+r:e,t.ignoreCase?"gi":"g")}catch(e){}var u=null;l&&(u=(e=(document.webkitFullscreenElement||document.documentElement).innerText).match(l)||e.replace(t.A0Re," ").match(l));t.regexMatches=n?u:null;t.parsedRegexp=n?l:null;t.activeRegexIndex=0;t.matchCount=u?u.length:0},FormatQuery:function(e){var t=e.charCodeAt(1),i=97<=t,n=VFindMode;if(92===t)return e;if(73===(t&=223)||67===t)n.ignoreCase=i===(73===t);else if(87===t){if(n.isRegex)return e;n.wholeWord=i}else n.isRegex=i;return""},restoreSelection:function(e){var t=window.getSelection(),i=e?t.isCollapsed?null:t.getRangeAt(0):this.initialRange;if(i){t.removeAllRanges();t.addRange(i)}},getNextQueryFromRegexMatches:function(e){if(!this.regexMatches)return"";var t=this.matchCount;this.activeRegexIndex=t=(this.activeRegexIndex+(e?-1:1)+t)%t;return this.regexMatches[t]},execute:function(e,t){var i,n,o=0|(t=t?VUtils.safer(t):Object.create(null)).count||1,r=o<0,s=null,l=0,u,a=this.ignoreCase&&!t.caseSensitive;t.noColor||this.toggleStyle(1);r&&(o=-o);var c=this.isRegex,h=this.parsedRegexp;do{u=null!=e?e:c?this.getNextQueryFromRegexMatches(r):this.parsedQuery;if((n=this.find(u,!a,r,true,this.wholeWord,false,false))&&h&&(s=VDom.findSelectionParent(3))){h.lastIndex=0;var d=s.innerText;"string"==typeof d&&!h.exec(d)&&l++<9&&o++}}while(0<--o&&n);t.noColor||setTimeout(this.HookSel,0);(i=VEventMode.lock())&&!VDom.isSelected(document.activeElement)&&i.blur&&i.blur();this.hasResults=n},find:function(){try{return window.find.apply(window,arguments)}catch(e){return false}},RestoreHighlight:function(){return VFindMode.toggleStyle(0)},HookSel:function(){document.addEventListener("selectionchange",VFindMode&&VFindMode.RestoreHighlight,true)},toggleStyle:function(e){document.removeEventListener("selectionchange",this.RestoreHighlight,true);e||this.isActive||VDom.UI.toggleSelectStyle(false);this.styleOut.disabled=this.styleIn.disabled=!e},getCurrentRange:function(){var e=window.getSelection(),t;e.rangeCount?t=e.getRangeAt(0):(t=document.createRange()).setStart(document.body||document.documentElement,0);t.setEnd(t.startContainer,t.startOffset);this.initialRange=t}},VVisualMode={mode:0,hud:"",hudTimer:0,currentCount:0,currentSeconds:null,retainSelection:false,selection:null,activate:function(e,t){var i,n,o,r;this.init&&this.init();VDom.docSelectable=VDom.UI.getDocSelectable();this.movement.selection=this.selection=i=VDom.UI.getSelection();VUtils.remove(this);VUtils.push(this.onKeydown,this);n=VDom.selType(i);this.mode||(this.retainSelection="Range"===n);r="string"==typeof t.mode?t.mode.toLowerCase():"";this.mode=o=r?"caret"===r?2:"line"===r?3:(r="",1):1;if(2!==o){this.movement.alterMethod="extend";var s=VEventMode.lock();if(!s&&("Caret"===n||"Range"===n)){var l=i.getRangeAt(0).getBoundingClientRect(),u=l.left,a=l.top,c=l.right,h=l.bottom;VDom.getZoom(1);VDom.prepareCrop();VDom.cropRectToVisible(u,a,(u||c)&&c+3,(a||h)&&h+3)?"Caret"===n&&(this.movement.extendByOneCharacter(1)||this.movement.extend(0)):i.removeAllRanges();n=VDom.selType(i)}if("Range"!==n&&(!s||i.toString().length<=0)){o=2;r="caret"}}this.hudTimer&&clearTimeout(this.hudTimer);VHUD.show(this.hud=(r?r[0].toUpperCase()+r.substring(1):"Visual")+" mode",!!t.from_find);if(o!==this.mode){this.mode=o;this.prompt("No usable selection, entering caret mode\u2026",1e3)}VDom.UI.toggleSelectStyle(true);if(2!==o)return 3===o?this.movement.extendToLine():void 0;this.movement.alterMethod="move";if("Range"===n)this.movement.collapseSelectionTo(0);else if("None"===n&&this.establishInitialSelectionAnchor()){this.deactivate();VDom.UI.toggleSelectStyle(false);return VHUD.showForDuration("Create a selection before entering visual mode.")}this.movement.extend(1);return this.movement.scrollIntoView()},deactivate:function(e){if(this.mode){VUtils.remove(this);this.retainSelection||this.movement.collapseSelectionTo(e&&2!==this.mode?1:0);var t=VEventMode.lock();t&&VDom.getEditableType(t)&&t.blur&&t.blur();VDom.UI.toggleSelectStyle(false);this.mode=0;this.hud="";this.retainSelection=false;this.selection=this.movement.selection=null;return VHUD.hide()}},onKeydown:function(e){var t=e.keyCode,i=0;if(111<t&&t<132)return 112===t?2:0;if(13===t){8&(t=VKeyboard.getKeyStat(e))&&2!==this.mode&&(this.retainSelection=true);6&t?this.deactivate():this.yank(1===t||null);return 2}if(VKeyboard.isEscape(e)){this.currentCount||this.currentSeconds?this.resetKeys():this.deactivate(1);return 2}var n=VKeyboard.getKeyChar(e);if(!n){this.resetKeys();return 229===t||93===t?0:1}var o=VKeyboard.getKey(e,n),r;o=VEventMode.mapKey(o);if(r=this.currentSeconds){r=r[o];i=this.currentCount;this.resetKeys()}if(null!=r);else if(1===o.length&&(t=+o[0])<10&&(t||this.currentCount)){this.currentCount=10*this.currentCount+t;this.currentSeconds=null}else if(null==(r=this.keyMap[o]))this.currentCount=0;else if("object"==typeof r){this.currentSeconds=r;r=null}else{i=this.currentCount;this.currentCount=0}if(null==r)return 1===n.length&&n===o?2:1;this.commandHandler(r,i||1);return 2},resetKeys:function(){this.currentCount=0;this.currentSeconds=null},commandHandler:function(e,t){if(50<e){if(60<e)return VScroller.scrollBy(1,(61===e?1:-1)*t,0);if(53===e&&2!==this.mode){var i=1<this.selection.toString().length;this.movement.collapseSelectionTo(+i)}return this.activate(1,{mode:["visual","line","caret"][e-51]})}2===this.mode&&this.movement.collapseSelectionTo(0);0<=e?this.movement.runMovements(1&e,e>>>1,t):e.call(this,t);return 2===this.mode?this.movement.extend(1):3===this.mode?this.movement.extendToLine():0},establishInitialSelectionAnchor:function(){var e,t,i,n;if(!VDom.isHTML())return true;VDom.getZoom(1);VDom.prepareCrop();for(var o=document.createTreeWalker(document.body||document.documentElement,NodeFilter.SHOW_TEXT);e=o.nextNode();)if(50<=(i=e.data).length&&50<i.trim().length){if((t=e.parentElement)instanceof HTMLFormElement)continue;if(VDom.getVisibleClientRect(t)&&!VDom.getEditableType(t))break}if(!e)return true;n=i.match(/^\s*/)[0].length;this.selection.collapse(e,n);return!this.selection.rangeCount},prompt:function(e,t){this.hudTimer&&clearTimeout(this.hudTimer);this.hudTimer=setTimeout(this.ResetHUD,t);return VHUD.show(e)},ResetHUD:function(e){var t=VVisualMode;if(t&&!e){t.hudTimer=0;return t.hud?VHUD.show(t.hud):void 0}},find:function(t){if(VFindMode.query){var e=this.selection.getRangeAt(0);VFindMode.execute(null,{noColor:true,count:t});if(!VFindMode.hasResults){this.selection.removeAllRanges();this.selection.addRange(e);return this.prompt("No matches for "+VFindMode.query,1e3)}2===this.mode&&0<this.selection.toString().length&&this.activate(1,VUtils.safer({}))}else VPort.send({handler:"findQuery"},function(e){if(e){VFindMode.updateQuery(e);return VVisualMode.find(t)}return VVisualMode.prompt("No history queries",1e3)})},yank:function(e){var t=this.selection.toString();if(true===e){this.prompt(VHUD.showCopied(t,"",true),2e3);e=null}else{this.deactivate();null!=e||VHUD.showCopied(t)}VPort.post(null!=e?{handler:"openUrl",url:t,reuse:e}:{handler:"copy",data:t})},movement:{D:["backward","forward"],G:["character","line","lineboundary","paragraph","sentence","vimword","word","documentboundary"],alterMethod:"",diOld:0,diNew:0,noExtend:false,selection:null,wordRe:null,extend:function(e){return this.selection.modify("extend",this.D[e],"character")},modify:function(e,t){return this.selection.modify(this.alterMethod,this.D[e],this.G[t])},setDi:function(){return this.diNew=this.getDirection()},getNextForwardCharacter:function(e){var t=this.selection.toString();if(0<t.length&&!this.getDirection(true)){this.noExtend=true;return t[0]}this.extend(1);var i=this.selection.toString();if(i.length!==t.length||t!==i){(this.noExtend=e)&&this.extend(0);return i[i.length-1]}this.noExtend=false;return null},runMovements:function(e,t,i){if(5===t||6===t){if(e)return this.moveForwardByWord(5===t,i);t=6}for(var n=this.selection,o=this.alterMethod,r=this.D[e],s=this.G[t];0<i--;)n.modify(o,r,s)},moveForwardByWord:function(e,t){var i=null,n="extend"!==this.alterMethod;this.getDirection();this.diNew=1;this.noExtend=false;for(;0<t--;){do{if(this.noExtend&&this.moveByChar(n))return}while((i=this.getNextForwardCharacter(n))&&e===this.wordRe.test(i));do{if(this.noExtend&&this.moveByChar(n))return}while((i=this.getNextForwardCharacter(n))&&e!==this.wordRe.test(i))}i&&!this.noExtend&&this.extend(0)},hashSelection:function(){var e=this.selection.getRangeAt(0);return this.selection.toString().length+"/"+e.anchorOffset+"/"+e.focusOffset+"/"+this.selection.extentOffset+"/"+this.selection.baseOffset},moveByChar:function(e){var t=e||this.hashSelection();this.modify(1,0);return!e&&this.hashSelection()===t},reverseSelection:function(){var e=VEventMode.lock(),t=this.getDirection(true);if(e&&!(e instanceof HTMLFormElement)&&1<VDom.editableTypes[e.nodeName.toLowerCase()]){var i=this.selection.toString().length;this.collapseSelectionTo(1);this.diNew=this.diOld=1-t;for(;0<i--;)this.modify(this.diOld,0)}else{var n=this.selection.getRangeAt(0),o=t?"start":"end";this.diNew=this.diOld=1-t;this.collapse(this.diNew);this.selection.extend(n[o+"Container"],n[o+"Offset"])}},extendByOneCharacter:function(e){var t=this.selection.toString().length;this.extend(e);return this.selection.toString().length-t},getDirection:function(e){var t=1,i;if(e&&this.diOld===this.diNew)return this.diOld;(i=this.extendByOneCharacter(t)||this.extendByOneCharacter(t=0))&&this.extend(1-t);return this.diOld=0<i?t:i<0?1-t:1},collapseSelectionTo:function(e){0<this.selection.toString().length&&this.collapse(this.getDirection()-e)},collapse:function(e){return e?this.selection.collapseToStart():this.selection.collapseToEnd()},selectLexicalEntity:function(e,t){this.collapseSelectionTo(1);6===e&&this.modify(1,0);this.modify(0,e);this.collapseSelectionTo(1);return this.runMovements(1,e,t)},selectLine:function(e){this.alterMethod="extend";this.setDi()&&this.reverseSelection();this.modify(0,2);this.reverseSelection();for(;0<--e;)this.modify(1,1);this.modify(1,2);var t=this.getNextForwardCharacter(false);if(t&&!this.noExtend&&"\n"!==t)return this.extend(0)},extendToLine:function(){this.setDi();for(var e=2;0<e--;){this.modify(this.diOld,2);this.reverseSelection()}},scrollIntoView:function(){if(this.selection.rangeCount){var e=VDom.getElementWithFocus(this.selection,this.getDirection());return e?VScroller.scrollIntoView(e):void 0}}},keyMap:{l:1,h:0,j:3,k:2,e:13,b:12,w:11,")":9,"(":8,"}":7,"{":6,0:4,$:5,G:15,g:{g:14},B:12,W:11,v:51,V:52,c:53,a:{w:function(e){return this.movement.selectLexicalEntity(6,e)},s:function(e){return this.movement.selectLexicalEntity(4,e)}},n:function(e){return this.find(e)},N:function(e){return this.find(-e)},"/":function(){clearTimeout(this.hudTimer);return VFindMode.activate(1,VUtils.safer({returnToViewport:true}))},y:function(){return this.yank()},Y:function(e){this.movement.selectLine(e);return this.yank()},C:function(){return this.yank(true)},p:function(){return this.yank(0)},P:function(){return this.yank(-1)},o:function(){this.movement.setDi();return this.movement.reverseSelection()},"<c-e>":61,"<c-y>":62,"<c-down>":61,"<c-up>":62},init:function(){this.init=null;var e=this.keyMap,t=VUtils.safer,i;this.movement.wordRe=new RegExp("[_0-9A-Za-z\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\\u2db8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");t(e);t(e.a);t(e.g)}},VSettings,VHUD,VPort,VEventMode;VDom.UI={box:null,styleIn:null,styleOut:null,root:null,callback:null,flashLastingTime:400,addElement:function(e,o){var t=this.box=VDom.createElement("div"),i="function"==typeof t.attachShadow?2:"function"==typeof t.createShadowRoot?1:0,n;t.style.display="none";this.root=2===i?t.attachShadow({mode:"closed"}):1===i?t.createShadowRoot():t;"closed"===this.root.mode||(this.root!==t?this.root:window).addEventListener("load",function e(t){var i=t.target;if(Vomnibar){if(i===Vomnibar.box||i===VFindMode.box){VUtils.Stop(t);i.onload&&i.onload(t)}}else window.removeEventListener("load",e,true)},true);this.addElement=function(e,t,i){0===t||this.adjust();return this.root.insertBefore(e,true===i?this.root.firstElementChild:i||null)};this.css=function(e){this.box===this.root&&(this.box.id="VimiumUI");var t=this.styleIn=this.createStyle(e),i;this.root.appendChild(t);this.css=function(e){this.styleIn.textContent=e};(i=this._styleBorder)&&this.root.appendChild(i);if(3!==o){var n=function(e){1!==e&&(this.onload=null);var t=VDom.UI,i=t.box;i.hasAttribute("style")&&i.removeAttribute("style");t.callback&&t.callback()};VDom.isStandard?Promise.resolve(1).then(n):t.onload=n}if(0!==o)return this.adjust()};this.root.appendChild(e);if(n=this.styleIn)this.css(n);else{""===n||VPort.post({handler:"css"});2<=o&&this.adjust()}return e},addElementList:function(e,t){var i=VDom.createElement("div");i.className="R HM";for(var n=0,o=e;n<o.length;n++){var r;i.appendChild(o[n].marker)}var s=i.style,l=VDom.bZoom/VDom.dScale;s.left=t[0]+"px";s.top=t[1]+"px";1!==l&&(s.zoom=""+l);document.webkitIsFullScreen&&(s.position="fixed");return this.addElement(i,1,this._lastFlash)},adjust:function(e){var t=VDom.UI,i=document.webkitFullscreenElement,n=i&&!t.root.contains(i)?i:document.documentElement;n!==t.box.parentElement&&t.box.appendChild.call(n,t.box);(i||e)&&(i?addEventListener:removeEventListener)("webkitfullscreenchange",t.adjust,true)},toggle:function(e){if(e)return this.adjust();this.box.remove();removeEventListener("webkitfullscreenchange",this.adjust,true)},_styleBorder:null,ensureBorder:function(e){var t=this._styleBorder,i=!t;e||(e=VDom.getZoom());if(!(i?1<=e:t.vZoom===e)){t=t||(this._styleBorder=this.createStyle(""));var n=this.box===this.root?"#VimiumUI ":"";t.vZoom=e;t.textContent=n+".HUD, "+n+".IH, "+n+".LH { border-width: "+(""+.51/e).substring(0,5)+"px; }";i&&this.box&&this.addElement(t,0)}},createStyle:function(e,t){var i=(t||VDom).createElement("style");i.type="text/css";i.textContent=e;return i},css:function(e){this.styleIn=e},getDocSelectable:function(){var e=this.styleOut,t;return!(e&&!e.disabled)&&((!(e=document.body)||"none"!==((t=getComputedStyle(e)).userSelect||t.webkitUserSelect))&&"none"!==((t=getComputedStyle(document.documentElement)).userSelect||t.webkitUserSelect))},toggleSelectStyle:function(e){var t=this.styleOut;(e?VDom.docSelectable:!t||t.disabled)||((t=t||(this.styleOut=this.box.appendChild(this.createStyle("html, body, * { -webkit-user-select: auto; user-select: auto; }")))).disabled=!e)},getSelection:function(){var e=window.getSelection(),t,i;if(e.focusNode===document.documentElement&&(t=VScroller.current)){for(;i=t.parentNode;t=i);t.getSelection&&(e=t.getSelection()||e)}return e},getSelectionText:function(e){var t=window.getSelection(),i=t.toString(),n,o;!i||VEventMode.lock()||!(n=VScroller.current)||3!==VDom.getEditableType(n)||(o=t.getRangeAt(0).getBoundingClientRect()).width&&o.height||(i="");return e?i:i.trim()},removeSelection:function(e){var t=(e&&e.getSelection?e:window).getSelection();if(!t||"Range"!==VDom.selType(t)||!t.anchorNode)return false;t.collapseToStart();return true},click:function(e,t,i,n){t||(t=VDom.getVisibleClientRect(e));e===VDom.lastHovered||VDom.hover(e,t);VDom.mouse(e,"mousedown",t,i);n&&e!==VEventMode.lock()&&e!==document.activeElement&&e.focus&&e.focus();VDom.mouse(e,"mouseup",t,i);return VDom.mouse(e,"click",t,i)},simulateSelect:function(e,t,i,n,o){var r=window.scrollY;this.click(e,t,null,true);VDom.ensureInView(e,r);i&&this.flash(e);if(e===VEventMode.lock()){this.moveSel(e,n);return true===o?this.suppressTail(true):void 0}},moveSel:function(e,t){var i=e instanceof HTMLTextAreaElement?3:e instanceof HTMLInputElement?4:e.isContentEditable?5:0;if(0!==i&&!(t?"all-input"===t&&(3===i||5===i&&0<=e.textContent.indexOf("\n")):5===i||e.value.length<=0||3===i&&e.clientHeight+12<e.scrollHeight)){var n=window.getSelection();try{if(5===i){var o=document.createRange();o.selectNodeContents(e);n.removeAllRanges();n.addRange(o)}else e.select();t&&"end"!==t?"start"===t&&n.collapseToStart():n.collapseToEnd()}catch(e){}}},getVRect:function(e,t){VDom.getZoom(e);VDom.prepareCrop();if(t)return VDom.getClientRectsForAreas(t,[],[e]);var i=VDom.getVisibleClientRect(e),n=e.getBoundingClientRect(),o=VDom.fromClientRect(n);return i&&!VDom.isContaining(o,i)?i:VDom.NotVisible(null,n)?null:o},_lastFlash:null,flash:function(e,t){var i=this;t||(t=this.getVRect(e));if(t){var n=VDom.createElement("div"),o=!document.webkitIsFullScreen;n.className="R Flash";VDom.setBoundary(n.style,t,o);1!==VDom.bZoom&&o&&(n.style.zoom=""+VDom.bZoom);this.addElement(n);this._lastFlash=n;setTimeout(function(){i._lastFlash===n&&(i._lastFlash=null);n.remove()},this.flashLastingTime);return n}},suppressTail:function(e){var t,i,n;if(e)t=function(e){if(e.repeat)return 2;VUtils.remove(this);return 0};else{t=function(){i=Date.now();return 2};i=Date.now()+VSettings.cache.keyboard[0];n=setInterval(function(e){if(150<Date.now()-i||-1===e){clearInterval(n);VUtils&&VUtils.remove(t)}},75)}VUtils.push(t,t)},SuppressMost:function(e){VKeyboard.isEscape(e)&&VUtils.remove(this);var t=e.keyCode;return 121<t&&t<132||116===t?1:2}};(function(){function r(e){for(var t=Object.create(null),i=0,n=e.split(" ");i<n.length;i++){var o;t[n[i]]=true}return t}function s(e,t){t=VKeyboard.getKey(e,t);null!==d&&(t=d[t]||t);var i=(f||u)[t];if(null===f){if(null==i||null!==v&&t in v)return 0}else if(null==i){if(null==(i=u[t]))return m(0);0!==i&&(a="")}a+=t;if(0===i){V.post({handler:"key",key:a,lastKey:e.keyCode});return m(2)}f=1!==i?i:u;return 2}var l,u,a="",c=false,h=false,d=null,f=null,m=function(e){a="";f=null;return e},p=null,v=null,o=!!window.VimiumInjector,g="undefined"!=typeof browser&&!!(browser&&browser.runtime),V={port:null,_callbacks:Object.create(null),_id:1,post:function(e){return V.port.postMessage(e)},send:function(e,t){var i=++V._id;V.port.postMessage({_msgId:i,request:e});V._callbacks[i]=t},safePost:function(e){try{if(!V.port){V.connect((c?v?32:16:48)+(h?128:0)+(VDom.UI.styleIn?64:0));o&&setTimeout(V.TestAlive,50)}V.port.postMessage(e)}catch(e){VSettings.destroy()}},Listener:function(e){var t;if(t=e._msgId){var i=V._callbacks,n=i[t];delete i[t];return n(e.response)}return C[e.name](e)},TestAlive:function(){m&&!V.port&&VSettings.destroy()},ClearPort:function(){V.port=null;C.init&&VDom.allowScripts&&setTimeout(function(e){if(e)VSettings.destroy();else try{m&&V.connect(1)}catch(e){VSettings.destroy()}},2e3)},connect:function(e){var t=(g?browser:chrome).runtime,i={name:"vimium-c."+(4*+(window.top===window)+2*+document.hasFocus()+e)},n=this.port=o?t.connect(VimiumInjector.id,i):t.connect(i);n.onDisconnect.addListener(this.ClearPort);n.onMessage.addListener(this.Listener)}},y={onKeydown:function(e){if(c&&(true===e.isTrusted||null==e.isTrusted&&e instanceof KeyboardEvent)&&(!VScroller.keyIsDown||!VEventMode.OnScrolls[0](e))){var t,i=e.keyCode,n;if(n=VUtils.bubbleEvent(e));else if(w.isActive()){var o=w.global;if(o?o.code?i===o.code&&VKeyboard.getKeyStat(e)===o.stat:VKeyboard.isEscape(e):VKeyboard.isEscape(e)||(111<i&&(t=VKeyboard.getKeyName(e))&&(n=s(e,t)),false))if(w.lock===document.body&&w.lock)e.repeat&&w.focusUpper(i,true,e);else{n=o&&o.passExitKey?0:2;w.exit(e)}}else if(31<i||8===i||9===i||13===i)(t=VKeyboard.getKeyChar(e))&&0===(n=s(e,t))&&w.suppressType&&1===t.length&&(n=2);else if(27!==i||VKeyboard.getKeyStat(e));else if(null!==f){m(1);n=2}else if(!e.repeat&&VDom.UI.removeSelection())n=2;else if(VFindMode.isActive){VUtils.prevent(e);VFindMode.deactivate(2);n=2}else if(e.repeat&&!l[27]&&document.activeElement!==document.body){var r=document.activeElement;r&&r.blur&&r.blur()}else window.top!==window&&document.activeElement===document.body&&w.focusUpper(i,e.repeat,e);if(!(n<1)){1<n&&e.preventDefault();e.stopImmediatePropagation();l[i]=1}}},onKeyup:function(e){if(c&&(true===e.isTrusted||null==e.isTrusted&&e instanceof KeyboardEvent)){VScroller.keyIsDown=0;w.suppressType&&VDom.selType()!==w.suppressType&&VEventMode.setupSuppress();if(l[e.keyCode]){l[e.keyCode]=0;e.preventDefault();e.stopImmediatePropagation()}else if(p)return p(e)}},onFocus:function(e){if(false!==e.isTrusted){var t=e.target;if(t===window)return y.OnWndFocus();if(c){var i=w.lock;if(null===i||i!==document.activeElement){if(t===VDom.UI.box)return e.stopImmediatePropagation();if(null!=t.shadowRoot){var n=e.path,o=void 0,r=!!(o=n&&n[0])&&o!==window&&o!==t,s=r?[].indexOf.call(n,t):1;r?t=o:n=[t.shadowRoot];for(var l=y.onShadow;0<=--s;){var u=n[s];if(u instanceof ShadowRoot&&2!==u.vimiumListened){u.addEventListener("focus",l,true);u.addEventListener("blur",l,true);u.vimiumListened=2}}}if(VDom.getEditableType(t)){if(w.grabFocus){if(document.activeElement===t){e.stopImmediatePropagation();t.blur()}return}w.lock=t;w.mutable&&document.activeElement!==document.body&&(w.last=t)}}}}},onBlur:function(e){if(c&&false!==e.isTrusted){var t=e.target;if(t===window)return y.OnWndBlur();var i=e.path,n,o=!(n=i&&i[0])||n===window||n===t,r=t.shadowRoot;if(w.lock===(o?t:n)){w.lock=null;w.inputHint&&!w.hinting&&document.hasFocus()&&w.exitInputHint()}if(null!=r&&r instanceof ShadowRoot&&t!==VDom.UI.box){var s=y.onShadow;if(o)r.vimiumListened=1;else for(var l=[].indexOf.call(i,t);0<=--l;){var u=i[l];if(u instanceof ShadowRoot){u.removeEventListener("focus",s,true);u.removeEventListener("blur",s,true);u.vimiumListened=0}}}}},onActivate:function(e){false!==e.isTrusted&&(VScroller.current=e.path?e.path[0]:e.target)},OnWndFocus:function(){},OnWndBlur:function(){VScroller.keyIsDown=0;var e=y.OnWndBlur2;e&&e();l=Object.create(null);/a?/.test("");m(1)},OnWndBlur2:null,listenShadow:true,onShadow:function(e){if(false!==e.isTrusted){var t=y,i=t.listenShadow;if(i&&"focus"===e.type)return t.onFocus(e);if(!i||1===this.vimiumListened){var n=this.removeEventListener.bind(this),o=t.onShadow;n("focus",o,true);n("blur",o,true);this.vimiumListened=0}i&&t.onBlur(e)}},hook:function(e){var t=e?removeEventListener:addEventListener;t("keydown",this.onKeydown,true);t("keyup",this.onKeyup,true);1!==e&&t("focus",this.onFocus,true);t("blur",this.onBlur,true);g?t("click",y.onActivate,true):t.call(document,"DOMActivate",y.onActivate,true)}},b={Find:VFindMode,Hints:VHints,Marks:VMarks,scBy:VScroller.ScBy,scTo:VScroller.ScTo,Visual:VVisualMode,Vomnibar:Vomnibar,reset:function(){var e=w;VScroller.current=VDom.lastHovered=e.last=e.lock=e.global=null;e.mutable=true;e.ExitGrab();VEventMode.setupSuppress();VHints.isActive&&VHints.clean();VVisualMode.deactivate();VFindMode.init||VFindMode.toggleStyle(0);return y.OnWndBlur()},toggleSwitchTemp:function(e,t){var i=(t.key||"")+"",n=VSettings.cache,o=n[i],r='"'+i+'"',s="old"+i,l=t.value,u="boolean"==typeof l,a,c;if(i in n){if("boolean"==typeof o)u||(l=!o);else if(u)a=r+"is not a boolean switch";else if(n[s]===c)n[s]=o;else if(o===l){l=n[s];n[s]=c}}else a="unknown setting"+i;a||(a=false===(n[i]=l)?r+" has been turned off":"Now "+r+(true===l?" is on":" use "+JSON.stringify(l)));return VHUD.showForDuration(a,1e3)},enterInsertMode:function(e,t){var i=t.code,n=t.stat;if((w.global=t).hud)return x.show("Insert mode"+(i?": "+i+"/"+n:""))},passNextKey:function(t,e){var i=Object.create(null);t=Math.abs(t);var n=0;if(e.normal){var o=m;return(m=function(e){if(2===e&&--t<=0||1===e){x.hide();return(m=o)(2)}a="";f=u;x.show("Normal mode (pass keys disabled)"+(1<t?": "+t+" times":""));return e})()}VUtils.push(function(e){n+=+!i[e.keyCode];return-(i[e.keyCode]=1)},i);p=function(e){if(0===n||--n||--t){i[e.keyCode]=0;return x.show("Pass next "+(1<t?t+" keys.":"key."))}return y.OnWndBlur2()};y.OnWndBlur2=function(){p=null;VUtils.remove(i);y.OnWndBlur2=null;return x.hide()};return p({keyCode:0})},goNext:function(e,t){var i=t.rel,n=t.patterns;if(VDom.isHTML()&&!D.findAndFollowRel(i)){var o;return n.length<=0||!D.findAndFollowLink(n,"next"===i?"<":">")?VHUD.showForDuration("No links to go "+i):void 0}},reload:function(e,t){var i=t.force,n=t.hard,o=t.url;setTimeout(function(){o?window.location.href=o:window.location.reload(n||i)},17)},switchFocus:function(e,t){var i=w.lock;if(!i){if(!(i=w.last))return x.showForDuration("Nothing was focused",1200);if(!VDom.ensureInView(i)&&VDom.NotVisible(i))return x.showForDuration("The last focused is hidden",2e3);w.last=null;w.mutable=true;VDom.getZoom(i);VDom.prepareCrop();return VDom.UI.simulateSelect(i,null,false,"",true)}if("backspace"===t.act)VDom.ensureInView(i)&&document.execCommand("delete");else{w.last=i;w.mutable=false;i.blur()}},goBack:function(e,t){var i=Math.min(Math.abs(e),history.length-1);0<i&&history.go((e<0?-i:i)*(+t.dir||-1))},showHelp:function(e){if("exitHD"!==e){var t=window.innerWidth<400||window.innerHeight<320;if(!VDom.isHTML()){if(window===window.top)return;t=true}V.post({handler:"initHelp",wantTop:t})}},autoCopy:function(e,t){var i=VDom.UI.getSelectionText(1);if(!i){i=t.url?window.location.href:document.title;(t.decoded||t.decode)&&(i=VUtils.decodeURL(i));i.endsWith(" ")&&t.url&&(i=i.slice(0,-1)+"%20")}i.length<4&&!i.trim()&&" "===i[0]?i="":V.post({handler:"copy",data:i});return x.showCopied(i)},autoOpen:function(e,t){var i=VDom.UI.getSelectionText(),n=(t.keyword||"")+"";i&&VPort.evalIfOK(i)||V.post({handler:"openUrl",copied:!i,keyword:n,url:i})},searchAs:function(){V.post({handler:"searchAs",url:window.location.href,search:VDom.UI.getSelectionText()})},focusInput:function(e,t){w.inputHint&&(w.inputHint.hints=null);var i=VDom.getViewBox();VDom.prepareCrop();var n=VHints.traverse("*",VHints.GetEditable,true),r=t.select,s=n.length;if(0===s){w.exitInputHint();return x.showForDuration("There are no inputs to focus.",1e3)}if(1===s){w.exitInputHint();return VDom.UI.simulateSelect(n[0][0],n[0][1],true,r,true)}for(var o=0;o<s;o++){var l=n[o],u=l[0].tabIndex;l[2]=0<u?o/8192-u:o}var a=n.sort(function(e,t){return e[2]-t[2]}).map(function(e){var t=VDom.createElement("span"),i=VDom.fromClientRect(e[0].getBoundingClientRect());i[0]--,i[1]--,i[2]--,i[3]--;t.className="IH";VDom.setBoundary(t.style,i);return{marker:t,target:e[0]}});a[s=1===e&&w.last?Math.max(0,n.map(function(e){return e[0]}).indexOf(w.last)):0<e?Math.min(e,s)-1:Math.max(0,s+e)].marker.classList.add("S","IHS");VDom.UI.simulateSelect(n[s][0],n[s][1],false,r,false);VDom.UI.ensureBorder(VDom.wdZoom);var c=VDom.UI.addElementList(a,i),h=!!t.keep,d=!!t.passExitKey;w.exitInputHint();w.inputHint={box:c,hints:a};VUtils.push(function(e){var t=e.keyCode,i;if(9===t){var n=this.hints,o=s;s=(o+(e.shiftKey?-1:1))%n.length;w.hinting=true;VDom.UI.simulateSelect(n[s].target,null,false,r);n[o].marker.classList.remove("S","IHS");n[s].marker.classList.add("S","IHS");w.hinting=false;return 2}if(16===t||h&&(18===t||17===t||91===t));else{if(e.repeat)return 2;if(h?VKeyboard.isEscape(e)||13===t&&(8!==(i=VKeyboard.getKeyStat(e))&&(0!==i||this.hints[s].target instanceof HTMLInputElement)):229!==t&&123!==t){w.exitInputHint();return VKeyboard.isEscape(e)?h||!w.lock?2:d?-1:0:0}}return 0},w.inputHint)}},w={grabFocus:"complete"!==document.readyState,global:null,hinting:false,inputHint:null,suppressType:null,last:null,lock:null,mutable:true,init:function(){var e=document.activeElement,t=e!==document.body;l=Object.create(null);if(VSettings.cache.grabFocus&&this.grabFocus){if(t){this.last=null;e.blur&&e.blur();t=(e=document.activeElement)!==document.body}if(!t){VUtils.push(this.ExitGrab,this);addEventListener("mousedown",this.ExitGrab,true);return}}this.grabFocus=false;t&&VDom.getEditableType(e)&&(this.lock=e)},ExitGrab:function(e){var t=w;if(t.grabFocus){t.grabFocus=false;removeEventListener("mousedown",t.ExitGrab,true);VUtils.remove(t);!(e instanceof Event)||!(window.frames&&frames.length)&&window===window.top||V.safePost({handler:"exitGrab"});return e instanceof KeyboardEvent?0:void 0}},isActive:function(){if(this.suppressType)return false;if(null!==this.lock||this.global)return true;var e=document.activeElement;if(e&&true===e.isContentEditable&&e instanceof HTMLElement){this.lock=e;return true}return false},focusUpper:function(e,t,i){var n=VDom.parentFrame();if(n||t&&window.top!==window){VUtils.prevent(i);if(n){l[e]=1;var o=n.ownerDocument.defaultView,r=o.VEventMode;n.blur&&n.blur();if(r){o.VDom.UI.suppressTail(true);r.focus({key:e,mask:3})}else o.focus()}else if(2!==l[e]){V.post({handler:"nextFrame",type:1,key:e});l[e]=2}}},exit:function(e){var t=e.target;if(null!=t.shadowRoot&&t.shadowRoot instanceof ShadowRoot){if(t=this.lock){this.lock=null;t.blur()}}else(t===this.lock?(this.lock=null,1):VDom.getEditableType(t))&&t.blur();if(this.global){this.lock=null;this.global=null;return x.hide()}},onExitSuppress:null,exitInputHint:function(){var e=this.inputHint;if(e){this.inputHint=null;e.box.remove();VUtils.remove(e)}}},D={followLink:function(e){var t=e instanceof HTMLLinkElement&&e.href;if(t)b.reload(1,{url:t});else{VDom.ensureInView(e);VDom.UI.flash(e);setTimeout(function(){VDom.UI.click(e)},100)}return true},GetLinks:function(e){if(e instanceof HTMLElement&&!(e instanceof HTMLFormElement)){var t,i;if((e instanceof HTMLAnchorElement||(e instanceof HTMLButtonElement?!e.disabled:e.vimiumHasOnclick||e.getAttribute("onclick")||((t=e.getAttribute("role"))?"link"===(t=t.toLowerCase())||"button"===t:VHints.ngEnabled&&e.getAttribute("ng-click"))))&&(null==(t=e.getAttribute("aria-disabled"))||t&&"true"!==t.toLowerCase())){var n=e.getBoundingClientRect();2<n.width&&2<n.height&&"visible"===getComputedStyle(e).visibility&&this.push(e)}}},findAndFollowLink:function(e,t){var i=e.length,n=VHints.traverse("*",this.GetLinks,true,document);n.push(document.documentElement);for(var o=[],r,s,l=99,u,a=/\s+/,c=n.length-1;0<=--c;){var h=n[c];if(!(h.contains(n[c+1])||99<(s=h.innerText).length)&&(s||(s=(r=h.value)&&r.toLowerCase&&r||h.title))){s=s.toLowerCase();for(var d=0;d<i;d++)if(-1!==s.indexOf(e[d])){if(-1===s.indexOf(t)&&(u=s.split(a).length)<=l){u<l&&(l=u+1);o.push([(d<<23)+(u<<16)+o.length,s,h])}break}}}if(o.length<=0)return false;l=l+1<<16;for(var f=/\b/,d=(o=o.filter(function(e){return(8388607&e[0])<l}).sort(function(e,t){return e[0]-t[0]}))[0][0]>>>23;d<i;){s=e[d++];for(var m=new RegExp(f.test(s[0])||f.test(s.slice(-1))?"\\b"+s+"\\b":s,""),p=d<<23,v=0,g=o;v<g.length;v++){var V=g[v];if(p<V[0])break;if(m.test(V[1]))return this.followLink(V[2])}}return false},findAndFollowRel:function(e){for(var t=document.querySelectorAll("[rel]"),i=VUtils.safer({A:1,AREA:1,LINK:1}),n,o=0,r=t.length,s=/\s+/;o<r;o++){var l=t[o];if(!(l instanceof HTMLFormElement)&&l.tagName.toUpperCase()in i&&l instanceof HTMLElement&&(n=l.rel)&&0<=n.trim().toLowerCase().split(s).indexOf(e))return this.followLink(l)}return false}},E={more:false,node:null,timer:0,Focus:function(e){var t=e.mask,i=e.CSS,n=e.key;i&&VDom.UI.css(i);if(2!==t);else if(window.innerWidth<3||window.innerHeight<3||document.body instanceof HTMLFrameSetElement||E.hidden()){V.post({handler:"nextFrame",key:n});return}VEventMode.focusAndListen();m();VEventMode.suppress(n);var o=window.top!==window;if(o&&2===t){var r=document.documentElement;r&&(r.scrollIntoViewIfNeeded||r.scrollIntoView).call(r)}if(!(t<1)&&VDom.isHTML()){var s=E,l;if(l=s.node)s.more=true;else{(l=VDom.createElement("div")).className="R Frame"+(1===t?" One":"");s.node=l;s.timer=setInterval(s.Remove,o?350:200)}VDom.UI.addElement(l)}},hidden:function(){var e=VDom.parentFrame();if(!e)return false;var t=e.getBoundingClientRect();return t.height<1||t.width<1||"hidden"===getComputedStyle(e).visibility},Remove:function(e){var t=E,i=t.more;t.more=false;if(!i||-1===e){if(t.node){t.node.remove();t.node=null}clearInterval(t.timer)}}},x={tweenId:0,box:null,text:"",opacity:0,enabled:false,timer:0,showCopied:function(e,t,i){if(!e)return i?e:this.showForDuration("No "+(t||"text")+" found!",1e3);e.startsWith("chrome-")&&0<e.indexOf("://")&&(e=e.substring(e.indexOf("/",e.indexOf("/")+2))||e);e="Copied: "+(41<e.length?e.substring(0,41)+"\u2026":e+".");return i?e:this.showForDuration(e,2e3)},showForDuration:function(e,t){this.show(e);this.text&&(this.timer=setTimeout(this.hide,t||1500))},show:function(e,t){if(this.enabled&&VDom.isHTML()){this.opacity=1;this.text=e;if(this.timer){clearTimeout(this.timer);this.timer=0}var i=this.box;if(!i||!t&&""!==i.style.opacity){t||this.tweenId||(this.tweenId=setInterval(this.tween,40));if(!i){(i=VDom.createElement("div")).className="R HUD";i.textContent=e;if(!t){var n=i.style;n.opacity="0";n.visibility="hidden";VDom.UI.box||VDom.UI.ensureBorder()}VDom.UI.addElement(this.box=i,0,VHints.box)}}else{i.style.cssText="";i.firstChild.data=e}}},tween:function(e){if(VPort){var t=x,i=t.box,n=i.style,o=-1===e,r=o?0:+(n.opacity||1);if(r===t.opacity);else{if(0===r){i.firstChild.data=t.text;n.opacity=o?"":"0.25";n.visibility="";return VDom.UI.adjust()}document.hasFocus()?r+=r<t.opacity?.25:-.25:r=t.opacity}n.opacity=r<1?r:"";if(r===t.opacity){if(0===r){n.visibility="hidden";i.firstChild.data=""}clearInterval(t.tweenId);t.tweenId=0}}},hide:function(e){var t=x,i;if(i=t.timer){clearTimeout(i);t.timer=0}t.opacity=0;t.text="";if(t.box)if(-2===e){var n=t.box,o=n.style;o.opacity="0";o.visibility="hidden";n.firstChild.data=""}else!t.tweenId&&VHUD&&(t.tweenId=setInterval(t.tween,40));else;}},C={init:function(e){var t=C,i=e.load,n=e.flags;i.browser=g?window.StyleMedia?4:2:0;(VSettings.cache=i).onMac&&(VKeyboard.correctionMap=Object.create(null));VDom.specialZoom=!g&&61<=i.browserVer;t.keyMap(e);if(n){w.grabFocus=!(2&n);h=!!(1&n)}t.reset(e,1);if(c)w.init();else{w.grabFocus=false;y.hook(1);VSettings.uninit&&VSettings.uninit(1)}t.init=null;return VDom.documentReady(function(){x.enabled=true;y.OnWndFocus=V.safePost.bind(V,{handler:"focus"})})},reset:function(e,t){var i=e.passKeys,n=""!==i,o=VSettings.enabled;v=i&&r(i);VSettings.enabled=c=n;if(!t){h=!!e.forced;if(y.listenShadow=n){o||w.init();o&&!h||y.hook(0)}else b.reset();return VDom.UI.box?VDom.UI.toggle(n):void 0}},url:function(e){delete e.name;e.url=window.location.href;V.post(e)},eval:function(e){VPort.evalIfOK(e.url)},settingsUpdate:function(e){VUtils.safer(e);delete e.name;for(var t in e)VSettings.cache[t]=e[t]},focusFrame:E.Focus,exitGrab:w.ExitGrab,keyMap:function(e){function i(e){n(e,null);for(var t in e)0!==e[t]&&i(e[t])}var t=u=e.keyMap,n=Object.setPrototypeOf;n(t,null);for(var o in t){var r=t[o];0!==r&&1!==r&&i(r)}(d=e.mapKeys)&&n(d,null)},execute:function(e){e.CSS&&VDom.UI.css(e.CSS);return VUtils.execCommand(b,e.command,e.count,e.options)},createMark:function(e){return VMarks.createMark(e.markName)},showHUD:function(e){var t=e.text,i=e.CSS,n=e.isCopy;i&&VDom.UI.css(i);return t?n?x.showCopied(t):x.showForDuration(t):void 0},count:function(e){var t=parseInt(a,10)||1;V.post({handler:"cmd",cmd:e.cmd,count:t,id:e.id})},showHelpDialog:function(e){function t(){a.firstChild.data=(n?"Hide":"Show")+" advanced commands";s.classList.toggle("HelpAdvanced")}var i=e.html,n=e.advanced,o=e.optionUrl,r=e.CSS,s,l=b.showHelp,u,a;r&&VDom.UI.css(r);if(VDom.isHTML()){b.showHelp("exitHD");if(l===b.showHelp){(s=VDom.createElement("div")).className="R Scroll UI";s.id="HelpDialog";s.innerHTML=i;s.onclick=VUtils.Stop;for(var c=0,h=["mousedown","mouseup","wheel","contextmenu"];c<h.length;c++){var d;VUtils.suppressAll(s,h[c])}VSettings.cache.browserVer<48||s.addEventListener(g?"click":"DOMActivate",y.onActivate,true);var f=s.querySelector("#HClose");u=function(e){if(e instanceof Event)VUtils.prevent(e);else{f.onclick=null;f.removeAttribute("href");f.click()}var t=VDom.lastHovered;t&&s.contains(t)&&(VDom.lastHovered=null);(t=VScroller.current)&&s.contains(t)&&(VScroller.current=null);VUtils.remove(s);s.remove();b.showHelp=l};f.onclick=b.showHelp=u;a=s.querySelector("#OptionsPage");if(window.location.href.startsWith(o))a.remove();else{a.href=o;a.onclick=function(e){V.post({handler:"focusOrLaunch",url:o});return u(e)}}(a=s.querySelector("#AdvancedCommands")).onclick=function(e){e.preventDefault();n=!n;t();V.post({handler:"setSetting",key:"showAdvancedCommands",value:n})};n&&t();VSettings.cache.browserVer<41&&(s.style.position="fixed");VDom.UI.ensureBorder();VDom.UI.addElement(s,1,true);document.hasFocus()||VEventMode.focusAndListen();VUtils.push(function(e){if(w.lock||!VKeyboard.isEscape(e))return 0;VDom.UI.removeSelection(VDom.UI.root)||u();return 2},VScroller.current=s);if(3<=Vomnibar.status){VUtils.remove(Vomnibar);VUtils.push(Vomnibar.onKeydown,Vomnibar)}}}}};VPort={post:V.post,send:V.send,evalIfOK:function(t){if(!VUtils.jsRe.test(t))return false;0<=";".indexOf(t.substring(11).trim())||(VDom.allowScripts?setTimeout(function(){var e=VDom.createElement("script");e.type="text/javascript";e.textContent=VUtils.decodeURL(t).substring(11).trim();document.documentElement.appendChild(e);e.remove()},0):x.showForDuration("Here's not allowed to eval scripts"));return true}};VHUD=x;VEventMode={lock:function(){return w.lock},onWndBlur:function(e){y.OnWndBlur2=e},OnWndFocus:function(){return y.OnWndFocus()},focusAndListen:function(e,t){if(1===t){w.ExitGrab();var i=y.OnWndFocus,n=true;y.OnWndFocus=function(){n=false};window.focus();n&&c&&y.hook(0);(y.OnWndFocus=i)();if(e&&m)return e()}else setTimeout(function(){VEventMode.focusAndListen(e,1)},1)},focus:E.Focus,mapKey:function(e){return null!==d&&d[e]||e},scroll:function(e,t){if(e&&!e.shiftKey&&!e.altKey){var i=e.keyCode,n=1&i;if(32<i&&i<41){t&&VSettings.cache.smoothScroll&&VEventMode.OnScrolls[3](t,1);return 36<i?VScroller.scrollBy(1-n,i<39?-1:1,0):34<i?VScroller.scrollTo(1,0,n):e.ctrlKey||e.metaKey?void 0:VScroller.scrollBy(1,.5-n,"viewSize")}}},OnScrolls:[function(e){if(e.repeat){VUtils.prevent(e);return VScroller.keyIsDown=VScroller.maxInterval}if(this!==VEventMode.OnScrolls)return VEventMode.OnScrolls[3](this);VScroller.keyIsDown=0},function(e){if(false!==e.isTrusted){VUtils.prevent(e);return VEventMode.OnScrolls[3](this)}},function(e){if(e.target===this&&false!==e.isTrusted)return VEventMode.OnScrolls[3](this)},function(e,t){var i=t?addEventListener:removeEventListener;VScroller.keyIsDown=t||0;i.call(e,"keyup",this[1],true);i.call(e,"blur",this[2],true)}],setupSuppress:function(e){var t=w,i=t.onExitSuppress;t.onExitSuppress=t.suppressType=null;if(e){t.suppressType=VDom.selType();t.onExitSuppress=e}if(i)return i()},suppress:function(e){e&&(l[e]=1)},keydownEvents:function(e){return e?!c||!(l=e):l}};VSettings={enabled:false,cache:null,uninit:null,destroy:function(e,t){VSettings.enabled=c=false;y.hook(2);b.reset();var i=VSettings.uninit,n=VDom.UI;i&&i(2);VUtils=VKeyboard=VDom=VDom=VUtils=VHints=Vomnibar=VScroller=VMarks=VFindMode=VSettings=VHUD=VPort=VEventMode=VVisualMode=m=null;n.box&&n.toggle(false);e||console.log("%cVimium C%c in %o has been destroyed at %o.","color:red","color:auto",window.location.pathname.replace(/^.*(\/[^\/]+\/?)$/,"$1"),Date.now());if(V.port)try{V.port.disconnect()}catch(e){}o||location.protocol.startsWith("chrome")||t||(window.chrome=null);/a?/.test("")}};if(o){VimiumInjector.checkIfEnabled=V.safePost;VimiumInjector.getCommandCount=function(){return"-"!==a?parseInt(a,10)||1:-1}}y.hook(0);"about:blank"!==location.href||o?V.connect(1):(function(){try{var e=VDom.parentFrame(),t=e&&e.ownerDocument.defaultView.VFindMode;if(t&&t.box&&t.box===e){VSettings.destroy(true);t.onLoad(t.box);return}}catch(e){}V.connect(1)})()})();"VimiumInjector"in window||(function(){function i(e){var t=e.target;if(t instanceof Element&&t.getAttribute("data-vimium-secret")===s){e.stopImmediatePropagation();removeEventListener("VimiumHook",i,true);if(null===r){t.removeAttribute("data-vimium-secret");t.addEventListener("VimiumOnclick",n,true);r=t}}}function n(e){e.target.vimiumHasOnclick=true;e.stopPropagation()}function e(){var e=removeEventListener;e("VimiumOnclick",n,true);if(r){e.call(r,"VimiumOnclick",n,true);r.dispatchEvent(new CustomEvent("VimiumUnhook",{detail:s}))}null===r&&setTimeout(function(){e("VimiumHook",i,true)},1e3);r=false;VSettings&&(VSettings.uninit=null)}if(window.VSettings){var t=document,o=t.createElement("script"),r=null,s=""+(1e6*Math.random()+1|0);if(o instanceof HTMLScriptElement){o.type="text/javascript";addEventListener("VimiumHook",i,true);addEventListener("VimiumOnclick",n,true);VSettings.uninit=e;var VC='function(n){function s(e){var t=new m("VimiumOnclick");if(d(e))a(e,t);else{for(var i=e,n;n=i.parentElement;i=n)if(n instanceof V&&(i=n.parentElement)&&!u(h,i,n)){if(!(i=n.parentNode)||!u(h,i,n))return;n=i}if(null==(n=i.parentNode)){c(I,i);a(e,t);F(i)}else if(!(n instanceof g)&&n instanceof v&&!(i instanceof V)){var o=i.nextSibling;c(I,i);a(e,t);u(f,n,i,o)}}}function o(e){if(!e||e.detail===""+n){B=l.push=function(){return 1};l.length=0;M(U);I=null}}var e=EventTarget.prototype,t=e.addEventListener,l=[],i=t.apply,r=t.call,u=r.bind(r),a=r.bind(e.dispatchEvent),c=r.bind(document.appendChild),h=document.contains,d=h.bind(document),f=document.insertBefore,m="function"==typeof CustomEvent?CustomEvent:Event,p=HTMLAnchorElement,v=DocumentFragment,g=window.ShadowRoot||m,V=HTMLFormElement,y="function"==typeof Element?Element:HTMLElement,b=Function.prototype,w=b.toString,D=i.bind(w),E=i.bind(t),x=r.bind(t),C=document.createElement,S=y.prototype.setAttribute,A=y.prototype.getAttribute,F=r.bind(y.prototype.remove),k=removeEventListener,M=clearTimeout,H={toString (){var e=this;return D(e===H.addEventListener?t:e===H.toString?w:e,arguments)},addEventListener (e,t,i){var n=this;if("click"===e&&t&&!(n instanceof p||n instanceof V)&&n instanceof y){l.push(n);0===U&&(U=B())}var o=arguments.length;return 2===o?x(n,e,t):3===o?x(n,e,t,i):E(n,arguments)}};l.push=[].push,l.splice=[].splice;document.currentScript&&u(S,document.currentScript,"data-vimium-hook","");var T=function(){k("DOMContentLoaded",T,true);M(U);T=null;var e=document.documentElement;if(!e)return o();var t=u(C,document,"div"),i="data-vimium-secret";u(S,t,i,""+n);x(t,"VimiumUnhook",o,true);c(e,t),a(t,new m("VimiumHook")),F(t);if(null!=u(A,t,i))o();else{I=t;U=0<l.length?B():0}},I,U=setTimeout(T,1e3),B=setTimeout.bind(null,function(){var e=l.length,t=9<e?e-10:0,i=e-t;U=0<t?B():0;if(0<e)for(var n=0,o=l.splice(t,i);n<o.length;n++){var r;s(o[n])}},1);if("function"!=typeof y)return o();e.addEventListener=H.addEventListener;b.toString=H.toString;t("DOMContentLoaded",T,true)}',l=navigator.appVersion.match(/\bChrom(?:e|ium)\/(\d+)/),u=l&&+l[1]||0;u&&45 >u&&(VC=VC.replace(/\b(addEventListener|toString) \(/g, "$1:function $1("));o.async=false;o.textContent='"use strict";('+VC+")("+s+");";(t=t.documentElement||t).insertBefore(o,t.firstChild);o.remove();VDom.documentReady(function(){null===r&&setTimeout(function(){r||e()},17)});var a=69!==u;VDom.allowRAF=a;if(o.hasAttribute("data-vimium-hook"))a||requestAnimationFrame(function(){VDom.allowRAF=true});else{console.info("Some functions of Vimium C may not work because %o is sandboxed.",window.location.pathname.replace(/^.*(\/[^\/]+\/?)$/,"$1"));VDom.allowScripts=false;window.setTimeout=window.setInterval=function(e,t){var i=10<t?window.requestIdleCallback:null,n=function(){return e(-1)};return VDom.allowRAF?i?i(n,{timeout:t}):requestAnimationFrame(n):(Promise.resolve(1).then(n),1)}}}}})();